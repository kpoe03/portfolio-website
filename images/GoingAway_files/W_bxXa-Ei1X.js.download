if (self.CavalryLogger) { CavalryLogger.start_js(["90MLu"]); }

__d("NotificationCounter",["Arbiter","CrossWindowEventEmitter","DocumentTitle","JSLogger","MessengerEnvironment"],(function(a,b,c,d,e,f){__p&&__p();var g=new(b("CrossWindowEventEmitter"))("JewelBase"),h={messages:0,notifications:0,requests:0};a={init:function(){var a=this;b("Arbiter").subscribe("update_title",this._handleUpdate.bind(this));b("Arbiter").subscribe("jewel/count-updated",this._handleCountUpdate.bind(this));g.addListener("count-updated",function(b){a._handleCountUpdate("",b)})},getCount:function(){__p&&__p();var a=0;for(var c in h){var d=Number(h[c]);if(typeof h[c]==="string"&&isNaN(d))return h[c];if(isNaN(d)||d<0){b("JSLogger").create("jewels").error("bad_count",{jewel:c,count:h[c]});continue}a+=d}return a},updateTitle:function(){if(b("MessengerEnvironment").messengerui)return;var a=this.getCount();b("DocumentTitle").badge(a)},_handleCountUpdate:function(a,b){h[b.jewel]=b.count,this.updateTitle()},_handleUpdate:function(a,b){this.updateTitle()}};e.exports=a}),null);
__d("NotificationJewelController",["Arbiter","Bootloader","Event","EventProfiler","FunnelLogger","IndeterminateNotificationCounter","NotificationConstants","NotificationCounter","NotificationJewelFunnelLoggingConstants","NotificationSeenState","NotificationStore","NotificationUpdates","XWorkHubController","clearTimeout","createObjectFrom","curry","gkx","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){__p&&__p();var g=b("NotificationConstants").PayloadSourceType,h=b("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_EVENT,i=b("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_NAME,j=0,k=!1,l=null;function m(a){var c=b("NotificationSeenState").getUnseenCount();b("Arbiter").inform("jewel/count-updated",{jewel:a,count:c,animation:"none"},"state")}a=function(){"use strict";__p&&__p();function a(a,c){__p&&__p();var d=this,e=c.badgeAnimationData,f=c.classification,k=c.endPoint,n=c.isBizsite,o=c.list;c=c.unseenNotifs;k&&b("NotificationStore").registerEndpoint({endpointControllerName:k,classification:f});n?b("IndeterminateNotificationCounter").init(c.length):b("NotificationCounter").init();var p=b("Event").listen(a.getRoot(),"mouseover",function(){b("FunnelLogger").startFunnel(i),p&&p.remove(),p=null,b("FunnelLogger").appendAction(i,h.MOUSE_OVER_ON_JEWEL),d.eagerRender(o)}),q=null;b("Event").listen(a.getRoot(),"mouseover",function(){q=b("setTimeoutAcrossTransitions")(function(){b("Bootloader").loadModules(["QE2Logger"],function(a){a.logExposureForUser("www_jewel_tooltip_experiment")},"NotificationJewelController"),q=null},500)});b("Event").listen(a.getRoot(),"mouseout",function(){q&&b("clearTimeout")(q)});b("gkx")("678265")&&b("Event").listen(a.getButton(),"click",function(a){if(a.metaKey||a.ctrlKey){a=b("XWorkHubController").getURIBuilder().setString("ref","jewel").setString("tab","all").getURI();window.open(a,"notification_hub_tab_identifier")}});var r=!1,s=a.subscribe("opened",function(){r||(r=!0,b("EventProfiler").tagCurrentActiveInteractionsAs("FirstNotificationJewelOpen")),l&&l(),s&&s.unsubscribe(),s=null,o.open()}),t=o.pause.bind(o);a.subscribe("opened",function(){window.setTimeout(t,0),m(a.name),b("Bootloader").loadModules(["NotificationVPVs"],function(a){return a.clearImpressions()},"NotificationJewelController"),b("Arbiter").inform("notificationJewel/opened")});a.subscribe("closed",function(){o.unpause(),m(a.name),b("Arbiter").inform("notificationJewel/closed"),o.setFlyoutOpenState(!1)});a.subscribe("user-open",function(a,b){o.setFlyoutOpenState(!0)});a.isOpen()&&o.setFlyoutOpenState(!0);b("NotificationUpdates").subscribe("seen-state-updated",b("curry")(m,a.name));e&&(e.logWithQEUniverse&&b("Bootloader").loadModules(["QE2Logger"],function(a){return a.logExposureForUser(e.logWithQEUniverse)},"NotificationJewelController"),e.injectWithAnimation&&b("Bootloader").loadModules(["RelationshipDelightsBadge"],function(b){return b.inject(a,e.injectWithAnimation)},"NotificationJewelController"));b("NotificationUpdates").handleUpdate(g.INITIAL_LOAD,{seenState:b("createObjectFrom")(c,j)});m(a.name);b("Arbiter").inform("jewel_mounted")}var c=a.prototype;c.eagerRender=function(a){k||(k=!0,l=b("EventProfiler").notifyRunningEagerInteraction(["Notifications_Jewel_Button"],"click"),a.open())};return a}();e.exports=a}),null);
__d("NotificationBucketUtils",["JSResource"],(function(a,b,c,d,e,f){"use strict";a={getCustomModuleForType:function(a){switch(a){case"TICKER":return b("JSResource")("NotificationBucketTicker.react").__setRef("NotificationBucketUtils");default:return null}}};e.exports=a}),null);
__d("NotificationAsyncWrapper",["NotificationListConfig","React"],(function(a,b,c,d,e,f){"use strict";e.exports=b("NotificationListConfig").reactFiberAsyncNotifications?b("React").unstable_ConcurrentMode:b("React").Fragment}),null);
__d("NotificationJewelListBucketHeader.react",["cx","FDSText.react","React"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.isNotifsBiz===!0?b("React").createElement("div",{className:"_7ghi",id:"notif_jewel_bucket_header"},b("React").createElement(b("FDSText.react"),{size:"body3",weight:"bold"},a.title)):b("React").createElement("div",{className:"_fyy"},a.title.toUpperCase())}e.exports=a}),null);
__d("NotificationBucketGeneric.react",["cx","NotificationJewelListBucketHeader.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.props,c=a.ids,d=a.isNotifsBiz,e=a.isSingleBucketInList,f=a.listRenderer,g=a.startIndex;a=a.title;if(c.length===0)return null;f=f(c,g);return b("React").createElement("div",{className:"_32hm"},a&&!e?b("React").createElement(b("NotificationJewelListBucketHeader.react"),{isNotifsBiz:d,title:a}):null,b("React").createElement("ul",null,f))};return c}(b("React").Component);e.exports=a}),null);
__d("NotificationBucket.react",["cx","BootloadedComponent.react","NotificationBucketGeneric.react","NotificationBucketUtils","NotificationJewelListBucketHeader.react","React","XUISpinner.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.$1=function(){var a=this.props.bucket,c=a.bucketType;a=a.title;return b("React").createElement("div",null,b("React").createElement(b("NotificationJewelListBucketHeader.react"),{title:a,bucketType:c}),b("React").createElement(b("XUISpinner.react"),{className:"_1e00"}))};d.render=function(){var a=this.props,c=a.bucket,d=a.listRenderer;a=a.startIndex;var e=c.bucketType;e=b("NotificationBucketUtils").getCustomModuleForType(e);return!e?b("React").createElement(b("NotificationBucketGeneric.react"),babelHelpers["extends"]({},c,{isNotifsBiz:this.props.isNotifsBiz,isSingleBucketInList:this.props.isSingleBucketInList,listRenderer:d,startIndex:a})):b("React").createElement(b("BootloadedComponent.react"),babelHelpers["extends"]({bootloadLoader:e,bootloadPlaceholder:this.$1()},c))};return c}(b("React").Component);e.exports=a}),null);
__d("WebNotificationsBottomCollisionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:WebNotificationsBottomCollisionsLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:WebNotificationsBottomCollisionsLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:WebNotificationsBottomCollisionsLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setVC=function(a){this.$1.vc=a;return this};return a}();c={vc:!0};e.exports=a}),null);
__d("NotificationJewelList.react",["cx","fbt","Animation","ErrorBoundary.react","Event","FunnelLogger","JewelLogger","LogicalGrid.react","NotificationBucket.react","NotificationJewelFunnelLoggingConstants","NotificationListConfig","NotificationListItem.react","NotificationListPropTypes","NotificationListRetryFetchButton.react","NotificationVPVs","NotifTestIDs","React","ReactDOM","ScrollableArea.react","SubscriptionsHandler","TimeSlice","TrackingNodes","Vector","WebNotificationsBottomCollisionsTypedLogger","XUISpinner.react","clearTimeout","debounce","getObjectValues","gkx","isEmpty","performanceNowNoFallback","setTimeoutAcrossTransitions","throttle"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=b("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_EVENT,j=b("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_NAME;a=b("NotificationListConfig").numStoriesFromEndBeforeAFetchIsTriggered;var k=160,l=530,m=61,n=Math.ceil(m*a),o=430,p;function q(a){p!=a&&(new(b("WebNotificationsBottomCollisionsTypedLogger"))().log(),p=a)}c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.state={lastMeasuredHeight:null},d.$2=[],d.$6=new(b("SubscriptionsHandler"))(),d.$7=!1,d.$8=!1,d.$11=function(){__p&&__p();if(!d.$3||!d.$5)return;var a=b("ReactDOM").findDOMNode(d.$3);if(!a)return;var c=b("ReactDOM").findDOMNode(d.$5);if(!c)return;var e=b("NotificationVPVs").getValidatedRectangle(c);if(d.props.afterScroll){var f=function(){d.props.afterScroll(d.$9(),a,e)};c=b("Vector").getElementDimensions(c).y;var g=d.$5&&d.$5.getArea();g&&g.getContentHeight()>0&&d.$7===!1&&b("performanceNowNoFallback")&&b("getObjectValues")(d.props.notifs).length>0&&(d.$7=!0,b("JewelLogger").logJewelListComponentEvent({jewelName:"notifications",eventName:"list_population_initial",timestamp:b("performanceNowNoFallback")()}));g&&c>0&&g.getContentHeight()>=c?((b("gkx")("678282")||d.$8===!1)&&b("performanceNowNoFallback")&&(d.$8=!0,b("JewelLogger").logJewelListComponentEvent({jewelName:"notifications",eventName:"list_populated",timestamp:b("performanceNowNoFallback")()})),b("TimeSlice").guard(f,"NotificationJewelList afterScrollCallback",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()):f()}},d.$17=function(a,b){b=b||0;return a.map(function(a,c){a=d.props.notifs[a];if(!a)return null;c=c+b;return d.$18(a,c,c)})},d.$19=function(){d.setState(function(a){return babelHelpers["extends"]({},a,{lastMeasuredHeight:d.$10()})})},d.$20=function(){var a=b("debounce")(d.$19);d.$6.addSubscriptions(a);return a}(),d.$23=function(){d.props.onResetRetryCount&&d.props.onResetRetryCount()},d.$24=function(){b("FunnelLogger").appendAction(j,i.SCROLL_TO_FETCH),d.$11()},d.$25=b("throttle").acrossTransitionsWithBlocking(d.$24),c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.$9=function(){__p&&__p();if(!this.$4||!this.$5)return!1;var a=b("ReactDOM").findDOMNode(this.$5);if(!a)return!1;var c=b("ReactDOM").findDOMNode(this.$4);if(!c)return!1;var d=b("Vector").getElementDimensions(a).y;if(d===0)return!1;a=b("Vector").getElementPosition(a).y+d;d=b("Vector").getElementPosition(c).y;c=this.$5&&this.$5.getArea();c&&c.getScrollTop()>0&&d<a&&q(b("getObjectValues")(this.props.notifs).length);return d-n<a};d.$10=function(){var a=b("Vector").getViewportDimensions().y;a=Math.min(this.props.maxHeight||l,a-k);return a};d.$12=function(a){return this.$2.slice(0,a).reduce(function(a,b){return a+b},0)};d.$13=function(a){var b=0;a.forEach(function(a){a.ids&&a.ids.length!==0&&b++});return b<=1};d.$14=function(a){this.$2=a?a.map(function(a){return a.ids.length}):[]};d.$15=function(){var a=this,b=this.props.buckets;if(!b)return null;var c=this.$13(b);return b.map(function(b,d){return a.$16(b,d,c)})};d.$16=function(a,c,d){var e=this.$12(c);if(a.ids&&a.ids.length){var f=this.props.notifs,g=a.ids.filter(function(a){return!!f[a]});if(g.length===0)return null}return b("React").createElement("li",{key:c},b("React").createElement(b("NotificationBucket.react"),{bucket:a,isNotifsBiz:this.props.isNotifsBiz,isSingleBucketInList:d,listRenderer:this.$17,startIndex:e}))};d.$18=function(a,c,d){var e=a.alert_id;return b("React").createElement(b("ErrorBoundary.react"),{key:e},b("React").createElement(b("NotificationListItem.react"),{isNotifsBiz:this.props.isNotifsBiz,isNotifsIntl:this.props.isNotifsIntl,isRead:this.props.readState[e],onChevronHide:this.props.onChevronHide,onChevronShow:this.props.onChevronShow,onClick:this.props.onClick,onRead:this.props.onRead,parent:this,paused:this.props.paused,row:c,rowIndex:d,shortenTimestamp:this.props.shortenTimestamp,sourceView:this.props.sourceView,target:this.props.target,visible:!this.props.hiddenState[e],notification:a}))};d.$21=function(a){this.props.onNumNotificationsViewableChange&&this.props.onNumNotificationsViewableChange(a/m)};d.UNSAFE_componentWillMount=function(){this.$14(this.props.buckets),this.$6.addSubscriptions(b("Event").listen(window,"resize",this.$20)),this.$19()};d.componentDidMount=function(){var a=this.state.lastMeasuredHeight;a!=null&&this.$21(a);b("performanceNowNoFallback")&&b("JewelLogger").logJewelListComponentEvent({jewelName:"notifications",eventName:"list_did_mount",timestamp:b("performanceNowNoFallback")()})};d.UNSAFE_componentWillReceiveProps=function(a){if(a.buckets===this.props.buckets)return;this.$14(a.buckets)};d.componentDidUpdate=function(a,c){__p&&__p();if(this.props.paused&&!a.paused&&(this.props.shouldScroll&&this.$5)){a=this.$5.getArea();a&&a.scrollToTop(!1)}this.props.retryLimitReached&&b("JewelLogger").logJewelFail();a=this.state.lastMeasuredHeight;if(a!=null&&a!==c.lastMeasuredHeight){this.$21(a);this.$1&&(this.$1.stop(),delete this.$1);if(!b("isEmpty")(this.props.notifs)){c=b("ReactDOM").findDOMNode(this.$5);c&&(this.$1=new(b("Animation"))(c).to("height",a+"px").duration(100).go())}}var d=b("setTimeoutAcrossTransitions")(this.$11,0);this.$6.addSubscriptions({remove:function(){b("clearTimeout")(d)}})};d.componentWillUnmount=function(){this.$6.release(),this.$1&&(this.$1.stop(),delete this.$1)};d.$22=function(a,b){return b.indexOf(a)};d.$26=function(){var a=this;if(this.props.buckets&&this.props.buckets.length)return this.$15();var c=b("getObjectValues")(this.props.notifs).filter(Boolean).map(function(a){return a.alert_id});return b("getObjectValues")(this.props.notifs).filter(Boolean).map(function(b,d){var e=b.alert_id;e=a.$22(e,c);return a.$18(b,e,d)})};d.render=function(){__p&&__p();var a=this,c=this.props.notifs,d=null,e=null,f=o,g=null,i=b("React").createElement("ul",{"data-ft":b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.NOTIFICATION_JEWEL),"data-gt":this.props.tracking,"data-testid":b("NotifTestIDs").REACT_NOTIF_LIST});if(!b("isEmpty")(c))d=b("React").createElement(b("LogicalGrid.react"),{ref:function(b){return a.$3=b},component:i},this.$26()),e=this.state.lastMeasuredHeight;else if(!this.props.canFetchMore){c=this.props.isNotifsBiz&&this.props.emptyState?this.props.emptyState:h._("No new notifications");d=b("React").createElement("div",{className:"_572e","data-testid":b("NotifTestIDs").REACT_NOTIF_LIST},c)}this.props.canFetchMore&&(this.props.retryLimitReached&&this.props.onResetRetryCount!=null?g=b("React").createElement(b("NotificationListRetryFetchButton.react"),{handleRetryClick:this.$23}):g=b("React").createElement(b("XUISpinner.react"),{ref:function(b){return a.$4=b},paused:!this.props.currentlyFetching,className:"jewelLoading"}));i=null;if(this.props.upsell){c=this.props.upsell.module;i=b("React").createElement(c,this.props.upsell.props)}c="_50-t"+(this.props.showingChevron?" _2iy1":"");f=b("React").createElement(b("ScrollableArea.react"),{ref:function(b){return a.$5=b},width:f,fade:!0,persistent:!0,onScroll:this.$25},d,g);return b("React").createElement("div",{style:e?{height:e+"px"}:{},className:c},f,i)};return c}(b("React").Component);c.defaultProps={retryLimitExceeded:!1};c.propTypes=b("NotificationListPropTypes");e.exports=c}),null);
__d("ChatGroupLeaveConversationDialogBootloader",["Bootloader","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={show:function(a,c){b("Bootloader").loadModules(["MessengerDialogs.bs","MessengerState.bs","ChatGroupLeaveConversationDialog.react","MercuryIgnoredBlockedParticipants.bs","MessengerAdminGroupUtils"],function(d,e,f,g,h){e.compute(a,function(i){i=i.blocked_ids;var j=e.getThreadMetaNow(a,c),k=g.isPresentInGroupThread(a,i,j),l=(j==null?void 0:j.admins)&&(j==null?void 0:j.admins[a])!==void 0;d.showDialog(function(){return b("React").createElement(f,{isAdmin:l,isShown:!0,isWorkSyncedChat:h.isWorkSyncedGroupChat(j),onHide:function(){return d.removeDialog()},threadID:c,viewer:a,showCanAddBack:k})})})},"ChatGroupLeaveConversationDialogBootloader")}};e.exports=a}),null);
__d("FantaDropdownMenuLeaveConversation",["ix","cx","fbt","Bootloader","ChatGroupLeaveConversationDialogBootloader","Dialog","FantaDropdownMenuWebDriverTestIDs","FantaTabActions","Image.react","MercuryLogMessageType","MercuryMessageObject","MercurySourceType","MercuryMessageActions","MessengerAdminGroupUtils","MessengerState.bs","React","asset","qex"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("MercuryMessageObject").get(),k=b("MercuryMessageActions").get();function l(a){a=b("MessengerAdminGroupUtils").isWorkSyncedGroupChat(a);a=a?i._("Leave Chat and Group"):i._("Leave group");return b("React").createElement("div",{className:"_6pdg","data-testid":b("FantaDropdownMenuWebDriverTestIDs").LEAVE_CONVERSATION},b("React").createElement(b("Image.react"),{className:"_6ng3",src:g("637999")}),b("React").createElement("span",{className:"_6ng4"},a))}function m(a,c,d,e){return function(){b("qex")._("922586")===!0?b("ChatGroupLeaveConversationDialogBootloader").show(d,c):n(a,c,d),p(e)}}function n(a,c,d){var e=[];e.push({name:"unsubscribe",label:i._("Leave Conversation"),handler:function(){return o(c,d)}});e.push(b("Dialog").CANCEL);var f,g=b("MessengerAdminGroupUtils").isWorkSyncedGroupChat(a);a=(a==null?void 0:a.admins)&&(a==null?void 0:a.admins[d])!==void 0;g&&a?f=i._("Leaving this group will remove you as an owner and allow other members to manage the chat thread. You will no longer be able to send and receive messages. You will also be removed from the group."):g?f=i._("You will stop receiving messages from this conversation and people will see that you left. You will also be removed from the group."):a?f=i._("Leaving this group will remove you as an owner and allow other members to manage the group. You will no longer be able to send and receive messages."):f=i._("You will stop receiving messages from this conversation and people will see that you left.");a=g?i._("Leave Group and Chat?"):i._("Leave Conversation?");new(b("Dialog"))().setTitle(a).setBody(f).setButtons(e).show()}function o(a,c){if(!b("MessengerState.bs").isEmptyLocalThread(c,a)){c=j.constructLogMessageObject(b("MercurySourceType").CHAT_WEB,a,b("MercuryLogMessageType").UNSUBSCRIBE,{removed_participants:[c]});k.send(c)}b("FantaTabActions").closeTab(a);return!0}function p(a){b("Bootloader").loadModules(["FantaDropdownMenuFunnelLogger","FantaDropdownMenuFunnelLoggerConstants"],function(b,c){b.logMenuItem(c.OPTIONS.LEAVE_CONVERSATION,a)},"FantaDropdownMenuLeaveConversation")}function a(a,c){var d=[];d.push({name:"unsubscribe",label:i._("Leave Conversation"),handler:function(){return o(a,c)}});d.push(b("Dialog").CANCEL);var e=i._("You will stop receiving messages from this conversation and people will see that you left."),f=i._("Leave Conversation?");new(b("Dialog"))().setTitle(f).setBody(e).setButtons(d).show()}function c(a,b,c,d,e){return a===!0?{type:"item",label:l(b),onClick:m(b,c,d,e)}:null}e.exports={getMenuItem:c,showLeaveDialog:a}}),null);
__d("WebMessengerConfirmBlockDialog",["fbt","React","SimpleXUIDialog","XUIDialogButton.react"],(function(a,b,c,d,e,f,g){"use strict";a={show:function(a){a=a&&a.length>0?g._("You have blocked {name}",[g._param("name",a)]):g._("You have blocked the sender");var c=g._("You can access messages you've blocked by going to the Filtered Messages list."),d=b("React").createElement("div",null,b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:g._("OK"),use:"confirm"}));b("SimpleXUIDialog").showEx(c,a,d)}};e.exports=a}),null);
__d("WebMessengerDeclineMRDialog",["fbt","FantaDropdownMenuLeaveConversation","MessengerBlockEntryPoint","MessengerParticipants.bs","React","SimpleXUIDialog","MercuryThreadActions","XUIDialogButton.react","XUIDialogCancelButton.react","MercuryIDs","MessengerMessageRequestsTypedLogger","WebMessengerConfirmBlockDialog","FantaTabActions","MessagingTag","CurrentUser"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("MercuryThreadActions").get();a={show:function(a,c,d,e){__p&&__p();var f=function(a){b("WebMessengerConfirmBlockDialog").show(a);a=b("MercuryIDs").getThreadKeyfromThreadIDUserID(c,b("CurrentUser").getID());b("FantaTabActions").closeTab(c);h.changeFolder(c,b("MessagingTag").OTHER);new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_block_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(c)).setSurface("thread").setFolderType(b("MessagingTag").PENDING).setThreadKey(a).setEntryPoint(null).log()};a=e?b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:g._("Leave Group"),use:"confirm",onClick:function(a){b("FantaDropdownMenuLeaveConversation").showLeaveDialog(c,b("CurrentUser").getID())}}):b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:g._("Block"),use:"confirm",onClick:function(){h.blockMessages(c,b("MessengerBlockEntryPoint").DECLINE_MR,f)}});var i=b("CurrentUser").isWorkUser(),j=b("MessengerParticipants.bs").getNow(b("MercuryIDs").getParticipantIDFromFromThreadID(c));j=j==null?void 0:j.short_name;var k=!e&&!i&&j?g._("Don't want to hear from {name}?",[g._param("name",j)]):g._("Decline Conversation");e?e=g._("Would you like to leave the group? Group members will see that you've left."):j?e=i?g._("Message request will be declined. Would you like to block {name} on Workplace Chat or delete these messages?",[g._param("name",j)]):g._("You can permanently delete the conversation, block {name} from sending you messages or tell us if something's wrong. We won't tell {name} you've taken these actions.",[g._param("name",j)]):e=g._({"Workplace chat":"Message request will be declined. Would you like to block this person on Workplace chat or delete these messages?","Messenger":"Message request will be declined. Would you like to block this person on Messenger or delete these messages?"},[g._enum(i?"Workplace chat":"Messenger",{"Workplace chat":"Workplace chat",Messenger:"Messenger"})]);j=b("CurrentUser").getID();var l=b("MercuryIDs").getThreadKeyfromThreadIDUserID(c,j);i=function(a){a==="hide"&&new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_cancel").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(c)).setSurface("thread").setFolderType(b("MessagingTag").PENDING).setThreadKey(l).setEntryPoint(null).log()};j=b("React").createElement("div",null,b("React").createElement(b("XUIDialogCancelButton.react"),null),b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:g._("Delete"),use:"confirm",onClick:function(){h["delete"](c),d&&d(),new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_delete_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(c)).setSurface("thread").setFolderType(b("MessagingTag").PENDING).setThreadKey(l).setEntryPoint(null).log()}}),a);b("SimpleXUIDialog").showEx(e,k,j,i,{})}};e.exports=a}),null);
__d("MercuryJewelCountControl",["Arbiter","CurrentUser","MercuryDispatcher","MercuryThreadInformer","MessengerState.bs","UserActivity"],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";__p&&__p();function a(a){__p&&__p();var c=this,d=b("MercuryDispatcher").get(),e=b("MercuryThreadInformer").get();this.render();d.subscribe("model-update-completed",function(a,b){c.$2(!1)});e.subscribe("unseen-updated",function(){return c.render()});e.subscribe("unread-updated",function(){return c.render()});this.$1=a;this.$1.subscribe("marked-seen",function(){c.$2(!0)})}var c=a.prototype;c.render=function(){var a=b("MessengerState.bs").getUnseenUnreadCountRaw(b("CurrentUser").getID());b("Arbiter").inform("jewel/count-updated",{jewel:"mercurymessages",count:a},"state")};c.$2=function(a){(a||this.$1.isOpen()&&b("UserActivity").isActive())&&b("MessengerState.bs").markAsSeen(b("CurrentUser").getID())};return a}();e.exports=a}),null);
__d("MercuryPresenceIndicator.react",["cx","fbt","Arbiter","AvailableListConstants","MercuryIDs","PresenceStatus","React","SubscriptionsHandler"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=b("React").PropTypes;c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$2=function(){if(!b("MercuryIDs").isCanonical(d.props.threadID))return null;else{var a=b("MercuryIDs").getUserIDFromThreadID(d.props.threadID);return b("PresenceStatus").get(a)}},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidMount=function(){var a=this;this.$1=new(b("SubscriptionsHandler"))();this.$1.addSubscriptions(b("Arbiter").subscribe(b("AvailableListConstants").ON_AVAILABILITY_CHANGED,function(){return a.forceUpdate()}))};d.componentWillUnmount=function(){this.$1&&this.$1.release()};d.render=function(){var a=this.$2();return b("React").createElement("span",{className:this.$3(a)},b("React").createElement("span",{className:"accessible_elem"},this.$4(a)))};d.$3=function(a){return"presenceIndicator"+(b("MercuryIDs").isGroupChat(this.props.threadID)?" groupThread":"")+(a==b("AvailableListConstants").ACTIVE?" presenceActive":"")};d.$4=function(a){switch(a){case b("AvailableListConstants").ACTIVE:return h._("Active");default:return null}};return c}(b("React").PureComponent);c.propTypes={threadID:a.string.isRequired};e.exports=c}),null);
__d("MercurySeenIndicator.react",["cx","MercuryIDs","MessengerReadReceipt.bs","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=b("MercuryIDs").getParticipantIDFromUserID(this.props.viewer);a=this.$1(a);return b("React").createElement("span",{className:"_3jy5"+(a?" repliedLast":"")+(a&&this.$2()?" seenByAll":"")})};d.$1=function(a){return a===this.props.thread.snippet_sender};d.$2=function(){return b("MessengerReadReceipt.bs").wasSeenByAll(this.props.readReceipts,{thread_id:this.props.thread.thread_id,author:this.props.thread.snippet_sender,timestamp:this.props.thread.timestamp})};return c}(b("React").Component);c.propTypes={thread:a.object.isRequired,viewer:a.string.isRequired};e.exports=c}),null);
__d("MercuryThreadPermalink.react",["Link.react","React","WebMessengerThreadPermalinks"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("React").PropTypes;c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={permalinkURI:"#"},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentDidMount=function(){this.$1(this.props)};d.UNSAFE_componentWillReceiveProps=function(a){(a.threadID!==this.props.threadID||a.folder!==this.props.folder)&&this.$1(a)};d.render=function(){return b("React").createElement(b("Link.react"),{className:this.props.className,href:this.state.permalinkURI,onClick:this.props.onClick,role:"button"},this.props.children)};d.$1=function(a){var c=this;this.setState({permalinkURI:"#"});b("WebMessengerThreadPermalinks").getThreadURI(a.threadID,function(a){return c.setState({permalinkURI:a})},a.folder)};return c}(b("React").PureComponent);c.propTypes={className:a.string,children:a.any,threadID:a.string.isRequired,viewer:a.string.isRequired,folder:a.string,onClick:a.func};e.exports=c}),null);
__d("MercuryThreadReadToggle.react",["fbt","invariant","MercuryThreadActions","React","ReadToggle.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=b("React").PropTypes;c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$1=function(a){a&&(a.preventDefault(),a.stopPropagation());a=b("MercuryThreadActions").getForFBID(d.props.viewer);d.props.unreadCount>0?a.markRead(d.props.threadID):a.markUnread(d.props.threadID)},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.render=function(){this.props.unreadCount>=0||h(0,6253);return b("React").createElement(b("ReadToggle.react"),{isRead:this.props.unreadCount===0,onClick:this.$1,readLabel:g._("Mark as Unread"),unreadLabel:g._("Mark as Read")})};return c}(b("React").PureComponent);c.propTypes={threadID:a.string.isRequired,viewer:a.string.isRequired,unreadCount:a.number.isRequired};e.exports=c}),null);
__d("MessagesJewelInlineThumbnail.react",["cx","MercuryAttachmentType","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.$1();if(a.length===0)return b("React").createElement("span",null);var c=a[0].thumbnail_url;if(!c)return b("React").createElement("span",null);c=b("React").createElement("span",{className:"_56hv"},b("React").createElement("i",{style:{backgroundImage:"url("+c+")"}}));a.length>1&&(c=b("React").createElement("span",null,b("React").createElement("span",{className:"_56hy"}),c));return c};d.$1=function(){var a=this.props.thread;return!a.snippet_attachments?[]:a.snippet_attachments.filter(function(a){return a.attach_type===b("MercuryAttachmentType").PHOTO})};return c}(b("React").Component);c.propTypes={thread:a.object.isRequired};e.exports=c}),null);
__d("MessagesJewelThreadlistRowPendingThreadButtonsReact.bs",["cx","fbt","bs_curry","React","Bootload.bs","Bootloader","MercuryIDs","ReasonReact.bs","MessagingTag","XUIButtonReact.bs","MercuryThreadActions","WebMessengerDeclineMRDialog","MessagingThreadCustomizationSource","MessengerMessageRequestsTypedLogger"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();function a(a){__p&&__p();var c=a.thread;a=a.userID;var d=function(a){b("Bootloader").loadModules(["BootloadableMessengerMessageRequestsTypedLogger.bs"],a,"MessagesJewelThreadlistRowPendingThreadButtonsReact.bs");return 0};d=[d];var e=b("Bootload.bs").Create(d),f=b("MercuryIDs").getThreadKeyfromThreadIDUserID(c.thread_id,a);d=function(a){a.preventDefault();a.stopPropagation();b("MercuryThreadActions").get().changeFolder(c.thread_id,b("MessagingTag").INBOX);return b("bs_curry")._1(e[0],function(){new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_accept_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(c.thread_id)).setThreadKey(f).log();return 0})};var g=function(){b("MercuryThreadActions").get()["delete"](c.thread_id,b("MessagingThreadCustomizationSource").INLINE);return 0};a=function(a){a.preventDefault();var d=b("MercuryIDs").isGroupChat(c.thread_id);b("WebMessengerDeclineMRDialog").show(c.folder,c.thread_id,g,d);a.stopPropagation();return b("bs_curry")._1(e[0],function(){new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_attempt").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(c.thread_id)).setThreadKey(f).log();return 0})};return b("React").createElement("div",{className:"_zjy"},b("ReasonReact.bs").element(void 0,void 0,b("XUIButtonReact.bs").make(void 0,d,h._("Accept"),2,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[])),b("ReasonReact.bs").element(void 0,void 0,b("XUIButtonReact.bs").make(void 0,a,h._("Decline"),0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[])))}c=a;f.make=c}),null);
__d("MessagesJewelThreadlistRowPendingThreadButtonsReact.re",["MessagesJewelThreadlistRowPendingThreadButtonsReact.bs"],(function(a,b,c,d,e,f){(function(a){return null});a=b("MessagesJewelThreadlistRowPendingThreadButtonsReact.bs").make;f.make=a}),null);
__d("MessagesJewelThreadListRow.react",["ix","cx","fbt","Bootloader","CurrentUser","Image.react","ImageBlock.react","ImmutableObject","MercuryPresenceIndicator.react","MercurySeenIndicator.react","MercuryThreadPermalink.react","MercuryThreadReadToggle.react","MercuryThreadSnippet.react","MercuryThreadTimestampReact.bs","MercuryThreadTitleSafe.react","MercuryTimestamp","MessageRequestUtils","MessagesJewelInlineThumbnail.react","MessagesJewelThreadlistRowPendingThreadButtonsReact.re","MessengerThreadImageReact.bs","MNAdsMessageRequestUtils","React","RTCCallState","UserAgent","XUIButton.react","asset","cxMargin","gkx","immutable"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("MercuryThreadTimestampReact.bs").jsComponent,k=b("MessagesJewelThreadlistRowPendingThreadButtonsReact.re").make,l=b("MessengerThreadImageReact.bs").jsComponent;a=b("React").PropTypes;c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$11=function(a){__p&&__p();a.preventDefault();a.stopPropagation();a=window.callWindow&&!window.callWindow.closed&&window.callWindow.focus;if(a)window.callWindow.focus();else{a=d.props.thread;var c=a.rtc_call_data,e=a.thread_fbid;b("Bootloader").loadModules(["FBRTCCore","FBRTCLogger"],function(a,d){d=d.Trigger;a.startGroupCall({conferenceName:"GROUP:"+e,hasVideo:c.call_state===b("RTCCallState").VIDEO_GROUP_CALL,serverInfoData:c.server_info_data,trigger:d.MULTIWAY_THREAD_LIST_JOIN_CALL_BUTTON})},"MessagesJewelThreadListRow.react")}},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.render=function(){var a=this.props.isDoNotDisturb&&b("CurrentUser").isWorkUser()&&b("gkx")("678573")?this.$1():this.$2();a=b("UserAgent").isBrowser("Chrome")&&!b("UserAgent").isPlatform("Windows")?b("React").createElement("div",{className:"author fixemoji"},this.$3(),a):b("React").createElement("div",{className:"author"},b("React").createElement("strong",null,this.$3()),a);a=b("React").createElement(b("ImageBlock.react"),{spacing:"none"},b("React").createElement("div",{className:"_p32"},this.$4()),b("React").createElement("div",{className:"content"},a,b("React").createElement("div",{className:"_1iji"},b("React").createElement("div",{className:"_1ijj"},this.$5(),this.$6()),b("React").createElement("div",null,this.$7())),b("React").createElement("div",{className:"time"},b("MNAdsMessageRequestUtils").isAdsMessageRequest(this.props.thread)?b("MNAdsMessageRequestUtils").renderAdsMessageRequestStatus():this.$8()),this.$9()),b("React").createElement("div",null,b("React").createElement(b("MessagesJewelInlineThumbnail.react"),{thread:this.props.thread}),b("React").createElement("div",{className:"x_div"},this.$10())));return b("React").createElement("li",{className:this.props.thread.unread_count>0?"jewelItemNew":""},b("React").createElement(b("MercuryThreadPermalink.react"),{className:"messagesContent",threadID:this.props.thread.thread_id,viewer:this.props.viewer,folder:this.props.thread.folder,onClick:this.props.onClick},a))};d.$7=function(){return!b("MessageRequestUtils").shouldShowThreadlistPendingActions(this.props.thread)?null:b("React").createElement(k,{userID:this.props.viewer,thread:this.props.thread})};d.$1=function(){return b("React").createElement(b("Image.react"),{className:"_3-9a",src:g("550341")})};d.$2=function(){return!this.props.showPresence?null:b("React").createElement(b("MercuryPresenceIndicator.react"),{threadID:this.props.thread.thread_id})};d.$4=function(a){return b("React").createElement(l,{size:48,thread:this.props.thread,useBackground:!0,viewer:this.props.viewer,participants:this.props.participants})};d.$3=function(){return b("React").createElement(b("MercuryThreadTitleSafe.react"),{thread:this.props.thread,viewer:this.props.viewer,showUnreadCount:!0})};d.$6=function(){return b("React").createElement(b("MercuryThreadSnippet.react"),{participants:this.props.participants,thread:this.props.thread,viewer:this.props.viewer})};d.$8=function(){return b("React").createElement(j,{time:this.props.thread.timestamp,title:b("MercuryTimestamp").getAbsoluteTimestamp(this.props.thread.timestamp),text:b("MercuryTimestamp").getRelativeTimestamp(this.props.thread.timestamp)})};d.$5=function(){return b("React").createElement(b("MercurySeenIndicator.react"),{thread:this.props.thread,viewer:this.props.viewer,readReceipts:this.props.readReceipts})};d.$10=function(){return b("React").createElement(b("MercuryThreadReadToggle.react"),{threadID:this.props.thread.thread_id,viewer:this.props.viewer,unreadCount:this.props.thread.unread_count})};d.$9=function(){if(!this.props.thread.rtc_call_data||this.props.thread.rtc_call_data.call_state===b("RTCCallState").NO_ONGOING_CALL)return null;var a=window.callWindow&&!window.callWindow.closed?i._("Return to Call"):i._("Join Call");return b("React").createElement(b("XUIButton.react"),{className:"_4oci",label:a,onClick:this.$11})};return c}(b("React").PureComponent);c.propTypes={onClick:a.func,participants:a.instanceOf(b("immutable").Map).isRequired,showPresence:a.bool,isDoNotDisturb:a.bool,thread:a.instanceOf(b("ImmutableObject")).isRequired,viewer:a.string.isRequired};e.exports=c}),null);
__d("MessagesJewelThreadlistRowContainer.react",["ChatOpenTab","ChatOpenTabEventLogger","CurrentUser","FantaTabActions","ImmutableObject","MercuryIDs","MercuryThreadlistRowContainer.react","MessagesJewelThreadListRow.react","MessagingTag","MessengerDiscoveryEntryPoint","MessengerMessageRequestsTypedLogger","React","ReactComponentWithPureRenderMixin","TimeSlice"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"MessagesJewelThreadlistRowContainer",mixins:[b("ReactComponentWithPureRenderMixin")],propTypes:{folder:a.string,readReceipts:a.any,thread:a.instanceOf(b("ImmutableObject")).isRequired,viewer:a.string.isRequired,handleChatTabOpen:a.func},render:function(){return b("React").createElement(b("MercuryThreadlistRowContainer.react"),{ChildClass:b("MessagesJewelThreadListRow.react"),onClick:this._handleClick,showPresence:b("ChatOpenTab").canOpenTab(),readReceipts:this.props.readReceipts,thread:this.props.thread,viewer:this.props.viewer})},_handleClick:function(a){__p&&__p();if(a.button===1||a.altKey||a.ctrlKey||a.metaKey||a.shiftKey)return;if(!b("ChatOpenTab").canOpenTab())return;this.props.handleChatTabOpen&&b("TimeSlice").guard(this.props.handleChatTabOpen,"Jewelupdate after Chat tab open",{propagationType:b("TimeSlice").PropagationType.ORPHAN})();a.preventDefault();a=this.props.thread.thread_id;var c=b("CurrentUser").getID();c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(a,c);b("FantaTabActions").openTab(a,[b("MessengerDiscoveryEntryPoint").FB_HEADER_DOCK_JEWEL_THREAD]);b("ChatOpenTabEventLogger").logClickOpen("jewel",a);var d;switch(this.props.folder){case"inbox":d="inbox";break;case"pending":d="pending";break;case"other":d="other";break}this.props.thread.folder!==b("MessagingTag").INBOX&&new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_thread_open").setThreadID(b("MercuryIDs").getUserIDFromThreadID(a)).setSurface(d).setFolderType(this.props.thread.folder).setThreadKey(c).log()}});e.exports=c}),null);
__d("MessengerMessageRequestsInfoReact.re",["MessengerMessageRequestsInfoReact.bs"],(function(a,b,c,d,e,f){(function(a){return null});a=b("MessengerMessageRequestsInfoReact.bs").make;f.make=a}),null);
__d("MessagesJewelThreadList.react",["cx","fbt","Arbiter","ChatConfig","CurrentUser","EventProfiler","ImmutableObject","Link.react","MessagesJewelThreadlistRowContainer.react","MessagingTag","MessengerMessageRequestsInfoReact.re","MessengerState.bs","React","ScrollableArea.react","SubscriptionsHandler","TimeSlice","XUISpinner.react","debounce","getViewportDimensions","gkx","requestIdleCallback","requireWeak","throttle"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("MessengerMessageRequestsInfoReact.re").component,j=160,k=60,l=10;a=b("React").PropTypes;c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$1=new(b("SubscriptionsHandler"))(),d.$4=function(){if(d.props.isLoaded||!d.$5)return;var a=d.$5.getArea();if(!a)return;a.getScrollTop()+a.getClientHeight()>=a.getScrollHeight()-1&&(d.props.onLoadMoreRequest&&d.props.onLoadMoreRequest())},d.$10=function(a){a.preventDefault(),d.props.onLoadMoreRequest&&d.props.onLoadMoreRequest()},d.$9=function(a){d.props.onFilteredRequestsClick&&d.props.onFilteredRequestsClick(a)},d.state={height:d.$3(),hasQP:!1},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidMount=function(){__p&&__p();var a=this;this.$2=Event.listen(window,"resize",b("debounce")(function(){a.setState({height:a.$3()})}));b("EventProfiler").informManualInteractionTimestamp(["Messages_Jewel_Button"],!0,"click");var c=b("ChatConfig").get("message_jewel_promotion_data");c&&this.setState({hasQP:!0},function(){a.setState({height:a.$3()})});this.$1.addSubscriptions(b("Arbiter").subscribeOnce("hideMessageJewelQP",function(){a.setState({hasQP:!1},function(){a.setState({height:a.$3()})})}));c=function(){b("requestIdleCallback")(function(){b("requireWeak")("FantaTabsEagerBootloader",function(a){return a.bootload()})})};b("TimeSlice").guard(c,"JewelOpen fanta eagerbootloader",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()};d.componentDidUpdate=function(a){a.threads.length===0&&this.props.threads.length!==0&&(this.props.onRenderThreads&&this.props.onRenderThreads()),b("EventProfiler").informManualInteractionTimestamp(["Messages_Jewel_Button"],!0,"click")};d.componentWillUnmount=function(){this.$2.remove(),this.$1.release()};d.render=function(){var a=this;return b("React").createElement(b("MessengerState.bs").jsComponent,{fbid:b("CurrentUser").getID()},function(c){return b("React").createElement(b("ScrollableArea.react"),{className:"_2q3u",height:a.state.height,onScroll:b("throttle")(a.$4,50),ref:function(b){return a.$5=b}},b("React").createElement("ul",{className:"jewelContent"},a.$6(),a.props.threads.map(function(d){return a.$7(d,b("MessengerState.bs").pendingFolderUnseenCount(c),b("MessengerState.bs").readReceiptsPerThread(c))})),a.$8())})};d.$7=function(a,c,d){return b("React").createElement(b("MessagesJewelThreadlistRowContainer.react"),{folder:this.props.folder,key:a.thread_id,thread:a,viewer:this.props.viewer,handleChatTabOpen:this.props.handleChatTabOpen,readReceipts:d})};d.$3=function(){var a=(this.props.maxInitialThreadCount||l)*k-(this.state&&this.state.hasQP?260:0);return Math.min(a,b("getViewportDimensions")().height-j)};d.$8=function(){if(this.props.isLoaded)return this.props.folder===b("MessagingTag").PENDING&&!(b("CurrentUser").isWorkUser()&&b("gkx")("762398"))?b("React").createElement("div",{className:"_16bh _16bi"},b("React").createElement(b("Link.react"),{onClick:this.$9},h._("See filtered messages"))):null;return this.props.isLoading?b("React").createElement(b("XUISpinner.react"),{className:"jewelLoading"}):b("React").createElement("div",{className:"_v8y"},b("React").createElement(b("Link.react"),{href:"#",onClick:this.$10},h._("Show Older")))};d.$6=function(){return!this.props.jewelRequestsUI||this.props.folder!==b("MessagingTag").PENDING?null:b("React").createElement("li",{className:"_16bh _2ph_"},b("React").createElement(i,null))};return c}(b("React").Component);c.propTypes={folder:a.string,isLoaded:a.bool,isLoading:a.bool,maxInitialThreadCount:a.number,jewelRequestsUI:a.bool,onFilteredRequestsClick:a.func,onLoadMoreRequest:a.func,onMessageRequestsClick:a.func,onRenderThreads:a.func,threads:a.arrayOf(a.oneOfType([a.instanceOf(b("ImmutableObject")),a.arrayOf(a.instanceOf(b("ImmutableObject")))])).isRequired,viewer:a.string.isRequired};e.exports=c}),null);
__d("MercuryJewelThreadlistControl",["csx","cx","fbt","ArbiterMixin","Bootloader","CSS","CurrentUser","DOM","Event","JSLogger","MercuryFilters.bs","MercuryServerRequests","MercuryThreadlistConstants","MercuryThreadlistContainer.react","MessagesJewelThreadList.react","MessagingTag","MessengerURIConstants","React","ReactDOM","gkx","mixin"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=b("JSLogger").create("mercury_jewel"),k=b("MessagingTag").PENDING,l="back_to_inbox",m=i._("See All in Messenger"),n=i._("See All in Workplace Chat");a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){__p&&__p();var d;d=a.call(this)||this;d.$JewelThreadlistControl13=function(a){a.preventDefault(),d.$JewelThreadlistControl9(b("MessagingTag").PENDING,b("MercuryFilters.bs").all)};d.$JewelThreadlistControl14=function(a){a.preventDefault(),d.$JewelThreadlistControl9(b("MessagingTag").OTHER,b("MercuryFilters.bs").all)};c=c.getFlyout();d.$JewelThreadlistControl1=[];d.$JewelThreadlistControl2=b("DOM").find(c,"._3v_l");d.$JewelThreadlistControl3=b("MessagingTag").INBOX;d.$JewelThreadlistControl4=b("MercuryFilters.bs").all;d.$JewelThreadlistControl5=b("CurrentUser").getID();d.$JewelThreadlistControl6={};d.$JewelThreadlistControl7={};d.$JewelThreadlistControl6[b("MessagingTag").INBOX]=b("DOM").find(c,"._1sde");d.$JewelThreadlistControl7[b("MessagingTag").INBOX]=b("DOM").find(c,"._1sdg");d.$JewelThreadlistControl8=b("MercuryServerRequests").getForFBID(d.$JewelThreadlistControl5);b("Event").listen(d.$JewelThreadlistControl6[b("MessagingTag").INBOX],"click",function(){return d.$JewelThreadlistControl9(b("MessagingTag").INBOX,b("MercuryFilters.bs").all)});!b("gkx")("678596")?(d.$JewelThreadlistControl6[k]=b("DOM").find(c,"._1sdf"),d.$JewelThreadlistControl7[k]=b("DOM").find(c,"._1sdh"),b("Event").listen(d.$JewelThreadlistControl6[k],"click",function(){return d.$JewelThreadlistControl9(k,b("MercuryFilters.bs").all)})):(d.$JewelThreadlistControl6[l]=b("DOM").find(c,"._34zq"),b("Event").listen(d.$JewelThreadlistControl6[l],"click",function(){return d.$JewelThreadlistControl9(b("MessagingTag").INBOX,b("MercuryFilters.bs").all)}));d.$JewelThreadlistControl10=b("DOM").find(c,"._1c1m");d.$JewelThreadlistControl11=b("DOM").find(c,"._4djt");b("Event").listen(d.$JewelThreadlistControl10,"click",function(a){d.$JewelThreadlistControl12(),a.kill()});d.render();j.bump("opened_threadlist_"+d.$JewelThreadlistControl3);return d}var d=c.prototype;d.render=function(){var a=this;b("Bootloader").loadModules(["MessengerState.bs","MercuryJewelUnreadCount.bs"],function(c,d){b("ReactDOM").render(b("React").createElement(c.jsComponent,{fbid:a.$JewelThreadlistControl5},function(d){return b("React").createElement(b("MercuryThreadlistContainer.react"),{ChildClass:b("MessagesJewelThreadList.react"),folder:a.$JewelThreadlistControl3,filter:a.$JewelThreadlistControl4,jewelRequestsUI:!b("gkx")("678596"),viewer:a.$JewelThreadlistControl5,onMessageRequestsClick:a.$JewelThreadlistControl13,onFilteredRequestsClick:a.$JewelThreadlistControl14,threadIDs:a.$JewelThreadlistControl1,threads:c.threads(d),threadlistOrderMap:c.threadlistOrderMap(d)})}),a.$JewelThreadlistControl2);var e=a.$JewelThreadlistControl7[b("MessagingTag").INBOX],f=a.$JewelThreadlistControl7[k];e&&b("ReactDOM").render(b("React").createElement(d.jsComponent,{viewer:a.$JewelThreadlistControl5,folder:b("MessagingTag").INBOX}),e);f&&b("ReactDOM").render(b("React").createElement(d.jsComponent,{viewer:a.$JewelThreadlistControl5,folder:k}),f)},"MercuryJewelThreadlistControl")};d.$JewelThreadlistControl12=function(){this.$JewelThreadlistControl8.markFolderAsRead(this.$JewelThreadlistControl3)};d.$JewelThreadlistControl9=function(a,c){__p&&__p();this.$JewelThreadlistControl1=[];if(this.$JewelThreadlistControl3!==a||this.$JewelThreadlistControl4!==c){var d=this.$JewelThreadlistControl3,e=a===b("MessagingTag").INBOX,f=a;j.bump("opened_threadlist_"+a);this.$JewelThreadlistControl6[f]&&b("CSS").addClass(this.$JewelThreadlistControl6[f],"_1sdd");this.$JewelThreadlistControl6[d]&&b("CSS").removeClass(this.$JewelThreadlistControl6[d],"_1sdd");f=b("CurrentUser").isWorkUser()?n:m;this.$JewelThreadlistControl3=a;this.$JewelThreadlistControl4=c;e?(this.$JewelThreadlistControl11.href=b("MessengerURIConstants").FACEBOOK_PREFIX,this.$JewelThreadlistControl11.text=f,this.$JewelThreadlistControl5=b("CurrentUser").getID()):a==k&&(this.$JewelThreadlistControl11.href=b("MessengerURIConstants").FACEBOOK_PREFIX+b("MessengerURIConstants").MESSAGE_REQUESTS_PATH,this.$JewelThreadlistControl11.text=f,this.$JewelThreadlistControl5=b("CurrentUser").getID());b("gkx")("678596")&&(b("CSS").conditionShow(this.$JewelThreadlistControl6[b("MessagingTag").INBOX],e),b("CSS").conditionShow(this.$JewelThreadlistControl6[l],!e));this.render()}};return c}(b("mixin")(b("ArbiterMixin")));e.exports=a}),null);
__d("MercuryJewel",["Arbiter","EventProfiler","MercuryDispatcher","MercuryJewelCountControl","MercuryServerPayloadPreprocessor","gkx"],(function(a,b,c,d,e,f){__p&&__p();var g=!1,h=!1,i=null;a=function(){"use strict";__p&&__p();function a(a,c){var d=this;b("gkx")("802350")?b("MercuryDispatcher").get().handlePreprocessedUpdate(c):b("MercuryServerPayloadPreprocessor").get().handleUpdate(c);this.$1=new(b("MercuryJewelCountControl"))(a);a.subscribeOnce("opened",function(){d.$2(a)});a.subscribeOnce("user-open",function(){d.$3(a)});a.subscribe("updated",function(b,c){c&&c.count>0&&d.$2(a)})}var c=a.prototype;c.$2=function(a){var c=this;this.$3(a);g||(g=!0,a.isOpen()||(i=b("EventProfiler").notifyRunningEagerInteraction(["Messages_Jewel_Button"],"click")),d(["MercuryJewelThreadlistControl"],function(b){c.$4=new b(a)}),b("Arbiter").inform("mercury-jewel/opened",null,"state"))};c.$3=function(a){!h&&a.isOpen()&&(h=!0,b("EventProfiler").tagCurrentActiveInteractionsAs("FirstMercuryJewelOpen"),i&&i())};return a}();e.exports=a}),null);
__d("MercuryJewelUnreadCount.bs",["fbt","React","ReasonReact.bs","bs_js_primitive","MessengerState.bs","MercuryThreadlistConstants"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").statelessComponent("MercuryJewelUnreadCount");function i(a,c,d){__p&&__p();return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(){__p&&__p();return b("React").createElement(b("MessengerState.bs").Provider[0],{fbid:a,children:function(a){var d=a[16][c];d=d!==void 0?d.size:b("bs_js_primitive").undefined_to_opt(a[17][c]);if(d!==void 0){a=d;if(a===0)return null;else return g._("({unread_count})",[g._param("unread_count",String(a>b("MercuryThreadlistConstants").MAX_UNREAD_COUNT?b("MercuryThreadlistConstants").MAX_UNREAD_COUNT:a))])}else return null}})},h[9],h[10],h[11],h[12]]}a=b("ReasonReact.bs").wrapReasonForJs(h,function(a){return i(a.viewer,a.folder,[])});f.component=h;f.make=i;f.jsComponent=a}),null);