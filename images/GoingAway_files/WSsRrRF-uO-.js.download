if (self.CavalryLogger) { CavalryLogger.start_js(["5lGmh"]); }

__d("SATPInteractionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:SATPInteractionsLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:SATPInteractionsLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:SATPInteractionsLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setCountry=function(a){this.$1.country=a;return this};c.setEventname=function(a){this.$1.eventname=a;return this};c.setPresetID=function(a){this.$1.preset_id=a;return this};c.setRankedPosition=function(a){this.$1.ranked_position=a;return this};c.setRequestedCollection=function(a){this.$1.requested_collection=a;return this};c.setServertime=function(a){this.$1.servertime=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setTrackingString=function(a){this.$1.tracking_string=a;return this};c.setUserActionString=function(a){this.$1.user_action_string=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var g={country:!0,eventname:!0,preset_id:!0,ranked_position:!0,requested_collection:!0,servertime:!0,time:!0,tracking_string:!0,user_action_string:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("ImageExif",["exif-js"],(function(a,b,c,d,e,f){__p&&__p();b("exif-js").enableXmp();function g(a){__p&&__p();var b=function(b){return a.charCodeAt(b)&255};this.getByteAt=b;this.getShortAt=function(a,b){a=this.getSShortAt(a,b);return a>0?a:a+65536};this.getSShortAt=function(a,c){var d=b(a);a=b(a+1);return c?(d<<8)+a:(a<<8)+d};this.getLongAt=function(a,b){a=this.getSLongAt(a,b);return a>0?a:a+4294967296};this.getSLongAt=function(a,c){var d=b(a),e=b(a+1),f=b(a+2);a=b(a+3);return c?(((d<<8)+e<<8)+f<<8)+a:(((a<<8)+f<<8)+e<<8)+d};this.getStringAt=function(b,c){return a.substr(b,c)};this.getLength=function(){return a.length}}a={readFromFile:function(a,b){var c=this,d=new FileReader();d.addEventListener("load",function(a){a=a.target.result;a=a instanceof ArrayBuffer?c.readFromArrayBuffer(a):c.readFromBinaryString(a);b(a)},!1);window.DataView?d.readAsArrayBuffer(a):d.readAsBinaryString(a)},readFromBinaryString:function(a){return b("exif-js").readFromBinaryFile(new g(a))},readFromArrayBuffer:function(a){return b("exif-js").readFromBinaryFile(a)}};e.exports=a}),null);
__d("StringEncoding",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b){__p&&__p();a=new Uint8Array(a);var c=0,d=[];while(c<a.length){var e=a[c],f=void 0;if(e>>7===0)f=1;else if(e>>5===6)e&=31,f=2;else if(e>>4===14)e&=15,f=3;else if(e>>3===30)e&=7,f=4;else if(e>>2===62)e&=3,f=5;else if(e>>1===126)e&=1,f=6;else throw new Error("Cannot decode as UTF-8 - unrecognised codepoint header");if(c+f>a.length)throw new Error("Cannot decode as UTF-8 - incomplete codepoint");for(var g=1;g<f;g++){var h=a[c+g];if(h>>6!==2)throw new Error("Cannot decode as UTF-8 - unrecognised codepoint subsequent byte");h&=63;e<<=6;e|=h}if(e>1114111)throw new Error("Cannot decode as UTF-8 - JavaScript doesn't support codepoints over 0x10FFFF");if(!e)switch(b){case"error":throw new Error("Cannot decode as UTF-8 - contains a null and we're not allowing them");case"ignore":continue;case"truncate":return String.fromCodePoint.apply(String,d);case"include":break}d.push(e);c+=f}return String.fromCodePoint.apply(String,d)}function g(a){return(a&255)<<8|a>>8}function b(a,b){__p&&__p();if(a.byteLength%2!==0)throw new Error("Cannot decode as UTF-16 - data length mod 2 != 0");a=new Uint16Array(a);var c=0,d=[],e=!1;a[0]===65279?++c:a[0]==65534&&(++c,e=!0);while(c<a.length){var f=a[c];e&&(f=g(f));var h=f;if(f>55295&&f<57344){if((f&64512)!==55296)throw new Error("Cannot decode as UTF-16 - incorrect signature for high surrogate");if(c+1>=a.length)throw new Error("Cannot decode as UTF-16 - incomplete codepoint");++c;var i=a[c];e&&(i=g(i));if((i&64512)!==56320)throw new Error("Cannot decode as UTF-16 - incorrect signature for low surrogate");h=((f&1023)<<10|i&1023)+65536}if(!h)switch(b){case"error":throw new Error("Cannot decode as UTF-16 - contains a null and we're not allowing them");case"ignore":continue;case"truncate":return String.fromCodePoint.apply(String,d);case"include":break}d.push(h);++c}return String.fromCodePoint.apply(String,d)}function h(a){return(a&255)<<24|(a&255<<8)<<8|(a&255<<16)>>8|a>>>24}function c(a,b){__p&&__p();if(a.byteLength%4!==0)throw new Error("Cannot decode as UTF-32 - data length mod 4 != 0");a=new Uint32Array(a);var c=0,d=[],e=!1;a[0]===65279?++c:a[0]==4294836224&&(++c,e=!0);while(c<a.length){var f=a[c];e&&(f=h(f));if(f&2147483648)throw new Error("Cannot decode as UTF-32 - invalid codepoint");if(f>1114111)throw new Error("Cannot decode as UTF-32 - JavaScript doesn't support codepoints over 0x10FFFF");if(!f)switch(b){case"error":throw new Error("Cannot decode as UTF-32 - contains a null and we're not allowing them");case"ignore":continue;case"truncate":return String.fromCodePoint.apply(String,d);case"include":break}d.push(f);++c}return String.fromCodePoint.apply(String,d)}var i={"utf-8":a,"utf-16":b,"utf-32":c};d=function(){__p&&__p();function a(a,b){__p&&__p();a?this.$1=a:this.$1=["utf-8","utf-16","utf-32"];b||(b="error");this.$2=b;for(var a=this.$1,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;this.$3(d)}}var b=a.prototype;b.getPrecedence=function(){return this.$1};b.decode=function(a){__p&&__p();var b=[];for(var c=this.$1,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;f=this.$3(f);try{return f(a,this.$2)}catch(a){b.push(a)}}throw new Error(b.join(", "))};b.$3=function(a){var b=i[a];if(!b)throw new Error("Unknown encoding "+a);return b};return a}();e.exports.Decoder=d}),null);
__d("ImageMetadata",["regeneratorRuntime","Promise","ImageExif","StringEncoding","emptyFunction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();c=function(){__p&&__p();function c(a){this.$4="",this.$6=a,this.$7=new Uint8Array(a),this.$8()}var d=c.prototype;d.$8=function(){__p&&__p();var a=0;while(a<this.$7.length){a=this.$9(a);if(a===-1)return;var b=this.$7[a+1];b=g[b];if(!b)return;var c=b.length;c===void 0&&(c=this.$7[a+2]*256+this.$7[a+3]);this.$10(a,c,b);if(b.name==="SOS")return;a+=2+c}};d.$10=function(a,b,c){switch(c.name){case"APP1":this.$11(a+4,h)?(this.$1||(this.$1=a,this.$2=b),this.$12(a+4+h.length,b-2-h.length)):this.$11(a+4,i)?(this.$1=a,this.$2=b,this.$13(a+4+i.length,b-2-i.length)):this.$11(a+4,j)&&this.$14(a+4+j.length,b-2-j.length);break;case"SOF0":case"SOF1":case"SOF2":case"SOF3":case"SOF5":case"SOF6":case"SOF7":case"JPG":case"SOF9":case"SOF10":case"SOF11":case"SOF13":case"SOF14":case"SOF15":this.$15(a+4,b-2);break}};d.$15=function(a,b){b=this.$7[a+3]*256+this.$7[a+4];a=this.$7[a+1]*256+this.$7[a+2];b>0&&a>0&&(this.$5={x:b,y:a})};d.$12=function(a,c){__p&&__p();a=emptyFunction;try{emptyFunction=b("emptyFunction");c=b("ImageExif").readFromArrayBuffer(this.$6)||{}}finally{emptyFunction=a}a={};for(var d in c){var e=c[d];typeof e==="string"&&(e=e.trim());a[d.trim()]=e}this.$3=a};d.$13=function(a,c){var d=new(b("StringEncoding").Decoder)(null,"truncate");try{d=d.decode(this.$6.slice(a,a+c));this.$4=d}catch(a){return}};d.$14=function(a){};d.$11=function(a,b){var c=this;return b.split("").every(function(b){return c.$7[a++]===b.charCodeAt(0)})};d.$9=function(a){for(var a=a;a+1<this.$7.length;++a)if(this.$7[a]===255&&this.$7[a+1]!==0&&this.$7[a+1]!==255)return a;return-1};d.hasAPP1=function(){return Boolean(this.$1)};d.hasExif=function(){return Boolean(this.$3)};d.hasXMP=function(){return Boolean(this.$4)};d.hasSize=function(){return Boolean(this.$5)};d.getAPP1Location=function(){return!this.hasAPP1()?null:this.$1};d.getAPP1Length=function(){return!this.hasAPP1()?null:this.$2};d.getExif=function(){if(!this.$3)throw new Error("Image has no Exif data");return this.$3};d.getXMPString=function(){return this.$4};d.getSize=function(){if(!this.$5)throw new Error("Could not find size data?!");return this.$5};d.getBufferLength=function(){if(!this.$6)throw new Error("Do not find buffer data!");return this.$6.byteLength};c.genMetadataFromBlob=function(a){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.t0=c;d.next=3;return b("regeneratorRuntime").awrap(c.$16(a));case 3:d.t1=d.sent;return d.abrupt("return",new d.t0(d.t1));case 5:case"end":return d.stop()}},null,this)};c.$16=function(c){return new(b("Promise"))(function(b,d){var e=new a.FileReader();e.onabort=d;e.onerror=d;e.onload=b;e.readAsArrayBuffer(c)})};return c}();var g=[];g[216]={name:"SOI",length:0};g[192]={name:"SOF0"};g[193]={name:"SOF1"};g[194]={name:"SOF2"};g[195]={name:"SOF3"};g[197]={name:"SOF5"};g[198]={name:"SOF6"};g[199]={name:"SOF7"};g[200]={name:"JPG"};g[201]={name:"SOF9"};g[202]={name:"SOF10"};g[203]={name:"SOF11"};g[205]={name:"SOF13"};g[206]={name:"SOF14"};g[207]={name:"SOF15"};g[196]={name:"DHT"};g[219]={name:"DQT"};g[221]={name:"DRI",length:2};g[218]={name:"SOS"};g[208]={name:"RST0",length:0};g[209]={name:"RST1",length:0};g[210]={name:"RST2",length:0};g[211]={name:"RST3",length:0};g[212]={name:"RST4",length:0};g[213]={name:"RST5",length:0};g[214]={name:"RST6",length:0};g[215]={name:"RST7",length:0};g[224]={name:"APP0"};g[225]={name:"APP1"};g[226]={name:"APP2"};g[227]={name:"APP3"};g[228]={name:"APP4"};g[229]={name:"APP5"};g[230]={name:"APP6"};g[231]={name:"APP7"};g[232]={name:"APP8"};g[233]={name:"APP9"};g[234]={name:"APP10"};g[235]={name:"APP11"};g[236]={name:"APP12"};g[237]={name:"APP13"};g[238]={name:"APP14"};g[239]={name:"APP15"};g[254]={name:"COM"};g[217]={name:"EOI",length:0};var h="Exif\0\0",i="http://ns.adobe.com/xap/1.0/\0",j="http://ns.adobe.com/xmp/extension/\0";e.exports=c}),null);
__d("XSphericalPhotoSphereMetadataAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/spherical_media/photo/metadata/",{})}),null);
__d("SphericalImageUtils",["Promise","ImageMetadata","XAsyncRequest","XSphericalPhotoSphereMetadataAsyncController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=2048;c={genArrayBufferFromBlob:function(c){__p&&__p();return new(b("Promise"))(function(b,d){if(a.FileReader){var e=new a.FileReader();e.onabort=d;e.onerror=d;e.onload=function(a){b(a.target.result)};e.readAsArrayBuffer(c)}else d(new Error("global.FileReader doesn't exit"))})},shouldCheckInServer:function(a){__p&&__p();if(!a.hasExif()&&!a.hasXMP()||!a.hasSize())return!1;var b=a.getXMPString();if(this.getMayContainSphericalMetadata(b))return!0;var c=a.getSize(),d=c.x;c=c.y;if(Math.max(d,c)<g||d/c<2&&c/d<2)return!1;c=a.hasExif()?a.getExif():{};return b===""&&(!c.Make||!c.Model)?!1:!0},genPhotosphereMetadata:function(a){var c=this;return new(b("Promise"))(function(d,e){c.genArrayBufferFromBlob(a).done(function(a){try{var f=new(b("ImageMetadata"))(a);c.shouldCheckInServer(f)?c.genPhotosphereMetadataFromServer(f.hasSize()?f.getSize():{x:0,y:0},f.getXMPString(),f.hasExif()?f.getExif():{}).done(function(a){a=a.payload;d({photoSphereMetadata:a,imageMetadata:f})},e):d({})}catch(a){a.__manual=!0,e(a)}},e)})},genPhotosphereMetadataFromServer:function(a,c,d){var e=this;return new(b("Promise"))(function(f,g){new(b("XAsyncRequest"))(b("XSphericalPhotoSphereMetadataAsyncController").getURIBuilder().getURI()).setMethod("POST").setData({exif_string:e.getExifString(d),height:a.y,width:a.x,xmp:c}).setHandler(f).setErrorHandler(g).send()})},getExifString:function(a){return JSON.stringify(a,function(a,b){return a==="FocalLength"&&b.numerator&&b.denominator?b.numerator+"/"+b.denominator:b})},getMayContainSphericalMetadata:function(a){return a!==""&&a.indexOf("GPano:")>-1}};e.exports=c}),null);
__d("SphericalImage",["regeneratorRuntime","SphericalImageUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="ProjectionType";a=function(){__p&&__p();function a(a){this.props=a}a.createFromBlob=function(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(b("SphericalImageUtils").genPhotosphereMetadata(a));case 2:c=d.sent;return d.abrupt("return",new this(c));case 4:case"end":return d.stop()}},null,this)};var c=a.prototype;c.isSpherical=function(){return Boolean(this.props.photoSphereMetadata)};c.getImageMetadata=function(){return this.props.imageMetadata};c.getPhotoSphereMetadata=function(){return this.props.photoSphereMetadata};c.getSize=function(){return this.props.imageMetadata?this.props.imageMetadata.getSize():null};c.getBufferLength=function(){return this.props.imageMetadata?this.props.imageMetadata.getBufferLength():null};c.getProjectionType=function(){var a="";this.props.photoSphereMetadata&&this.props.photoSphereMetadata[g]&&(a=this.props.photoSphereMetadata[g]);return a};return a}();e.exports=a}),null);
__d("SphericalPhotoUploadHelper",[],(function(a,b,c,d,e,f){"use strict";e.exports={shouldResize360:function(a,b,c){return b&&Math.max(b.x,b.y)<=c||a==="cubestrip"?!1:!0},shouldRecompress360:function(a,b,c){return b==null||b<=c||a==="cubestrip"?!1:!0}}}),null);
__d("XComposerPhotoUploader",["regeneratorRuntime","Promise","AsyncUploadRequest","FileInputUploader","JSLogger","PhotosMimeType","PhotosUploadID","ReactComposerMediaFilterUtils","SphericalImage","SphericalPhotoTypedConfig","SphericalPhotoUploadHelper","curry","emptyFunction","performanceNow","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("SphericalPhotoUploadHelper").shouldRecompress360,h=b("SphericalPhotoUploadHelper").shouldResize360,i=a.URL||a.webkitURL||{};c=function(){__p&&__p();function a(a){this.$2=a.uploadData||{},this.$1=a.uploadEndpoint,this.$3=a.retryLimit,this.$4=a.concurrentLimit,this.$5=a.resizer,this.$6=a.onUploadEnqueued||b("emptyFunction"),this.$7=a.onUploadsEnqueued||b("emptyFunction"),this.$8=a.onResizeStart||b("emptyFunction"),this.$11=a.onResizeProgress||b("emptyFunction"),this.$9=a.onResizeSuccess||b("emptyFunction"),this.$10=a.onResizeFailure||b("emptyFunction"),this.$12=a.onSphericalCheckFailure||b("emptyFunction"),this.$13=a.onSphericalCheckSuccess||b("emptyFunction"),this.$14=a.onUploadIsSpherical||b("emptyFunction"),this.$15=a.onUploadSent||b("emptyFunction"),this.$16=a.onUploadStart||b("emptyFunction"),this.$17=a.onUploadProgress||b("emptyFunction"),this.$18=a.onUploadSuccess||b("emptyFunction"),this.$19=a.onUploadFailure||b("emptyFunction"),this.$20=b("JSLogger").create("composer")}var c=a.prototype;c.setUploadEndpoint=function(a){this.$1=a};c.upload=function(a,c){__p&&__p();var d=this;c||0;c=Object.assign({},this.$2);var e=null;if(!this.$21(a)){var f=b("PhotosUploadID").getNewID();a.uploadID=f;c.upload_id=f;this.$6({uploadID:f,fileName:a.value.split("/").pop().split("\\").pop(),fileURL:i.createObjectURL?i.createObjectURL(a):null})}else{e=Array.from(a.files);e=e.filter(function(a){return!b("ReactComposerMediaFilterUtils").hasVideos([a.name])});if(e.length===0)return;e.forEach(function(a){a.uploadID||(a.uploadID=b("PhotosUploadID").getNewID()),d.$6({uploadID:a.uploadID,fileName:a.name,isSpherical:!1,fileURL:i.createObjectURL?i.createObjectURL(a):null})})}this.$7();f=new(b("FileInputUploader"))(a).setURI(this.$1).setData(c).setAllowCrossOrigin(!0).setNetworkErrorRetryLimit(this.$3).setUploadInParallel(!0);e&&e.length>0&&(f.setFiles({farr:e}),this.$5?f.setPreprocessHandler(this.$22.bind(this)):f.setPreprocessHandler(this.$23.bind(this)),this.$4&&f.setConcurrentLimit(this.$4));f.subscribe("progress",function(b,c){return d.$17(d.$24(c,a),c)});f.subscribe("failure",function(b,c){return d.$19(d.$24(c,a),c,e)});f.subscribe("start",function(b,c){return d.$16(d.$24(c,a),c)});f.subscribe("success",function(b,c){return d.$18(d.$24(c,a),c)});try{f.send(),this.$15(a)}catch(a){this.$20.error("error_send_unpublished_files",a);throw a}};c.uploadFiles=function(a){var c=this;a=Array.from(a);var d=[];a.forEach(function(a){var e=b("PhotosUploadID").getNewID();c.$6({fileName:a.name,fileURL:i.createObjectURL?i.createObjectURL(a):null,isSpherical:!1,uploadID:e});d.push(e)});a=this.getAsyncFileUploadRequest(a,d);a.send()};c.getAsyncFileUploadRequest=function(a,b,c){__p&&__p();var d=this;c=this.$25(a,c);c.subscribe("start",function(c,e){c=d.$26(a,b,e);d.$16(c,{upload:e})});c.subscribe("progress",function(c,e){c=d.$26(a,b,e);d.$17(c,{upload:e,event:e.getProgressEvent()})});c.subscribe("success",function(c,e){c=d.$26(a,b,e);d.$18(c,{upload:e,response:e.getResponse()})});c.subscribe("failure",function(c,e){c=d.$26(a,b,e);d.$19(c,{upload:e,response:e.getResponse()},a)});return c};c.getAsyncUploadRequest=function(a,b){__p&&__p();var c=this;b=this.$25(a,b);b.subscribe("start",function(a,b){return c.$16(b.getFile().uploadID,{upload:b})});b.subscribe("progress",function(a,b){return c.$17(b.getFile().uploadID,{upload:b,event:b.getProgressEvent()})});b.subscribe("success",function(a,b){return c.$18(b.getFile().uploadID,{upload:b,response:b.getResponse()})});b.subscribe("failure",function(b,d){return c.$19(d.getFile().uploadID,{upload:d,response:d.getResponse()},a)});return b};c.$25=function(a,c){c=new(b("AsyncUploadRequest"))().setData(Object.assign({},c&&c.data,this.$2)).setFiles({farr:a}).setAllowCrossOrigin(!0).setURI(this.$1);this.$4&&c.setLimit(this.$4);this.$5&&c.setPreprocessHandler(this.$22.bind(this));return c};c.$26=function(a,b,c){c=c.getFile();a=a.indexOf(c);return b[a]};c.$24=function(a,b){if(a.upload)return a.upload.getFile().uploadID;else return b.uploadID};c.$23=function(a,c){var d=this;b("promiseDone")(function(){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d.$27(a,c));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},null,this)}())};c.$27=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=a.getFile();f.next=3;return b("regeneratorRuntime").awrap(this.$28(d));case 3:e=f.sent,e&&e.isSpherical()?this.$14(d,e.isSpherical(),e.getProjectionType()):this.$14(d,!1,""),c(a);case 6:case"end":return f.stop()}},null,this)};c.$22=function(a,c){var d=this;b("promiseDone")(function(){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d.$29(a,c));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},null,this)}())};c.$28=function(a){__p&&__p();var c,d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:c=b("performanceNow")();e.prev=1;e.next=4;return b("regeneratorRuntime").awrap(b("SphericalImage").createFromBlob(a));case 4:d=e.sent;this.$13(a,b("performanceNow")()-c,d);return e.abrupt("return",d);case 9:e.prev=9;e.t0=e["catch"](1);this.$12(a,b("performanceNow")()-c);return e.abrupt("return",null);case 14:case"end":return e.stop()}},null,this,[[1,9]])};c.$30=function(a){return this.$31(this.$5.resizeBlob.bind(this.$5),a)};c.$32=function(a,c){c===void 0&&(c=b("SphericalPhotoTypedConfig").upload_size_limit);return this.$31(this.$5.resize360Blob.bind(this.$5),a,c)};c.$31=function(a,c,d){var e=this,f=b("curry")(this.$11,c.uploadID),g=function(){return e.$8(c)};return new(b("Promise"))(function(b,e){g(),a(c,function(a,c,d,f,g){a?e(a):d?b(null):b({blob:c,originalWidth:f,originalHeight:g})},f,d)})};c.$29=function(a,c){__p&&__p();var d,e,f,i,j,k,l,m,n,o,p,q;return b("regeneratorRuntime").async(function(r){__p&&__p();while(1)switch(r.prev=r.next){case 0:d=a.getFile();if(!(!d||!b("PhotosMimeType").isJpeg(d.type))){r.next=5;break}this.$14(d,!1,"");c(a);return r.abrupt("return");case 5:e=b("performanceNow")();r.prev=6;j=null;r.next=10;return b("regeneratorRuntime").awrap(this.$28(d));case 10:j=r.sent;if(!(j&&j.isSpherical())){r.next=31;break}this.$14(d,!0,j.getProjectionType());k=j.getSize();l=b("SphericalPhotoTypedConfig").upload_size_limit;m=j.getProjectionType();n=!1;n=g(m,j.getBufferLength(),b("SphericalPhotoTypedConfig").upload_bytes_limit);o=h(m,k,l);if(!(k&&(o||n))){r.next=29;break}if(o){r.next=26;break}r.next=23;return b("regeneratorRuntime").awrap(this.$32(d,Math.max(k.x,k.y)-1));case 23:f=r.sent;r.next=29;break;case 26:r.next=28;return b("regeneratorRuntime").awrap(this.$32(d));case 28:f=r.sent;case 29:r.next=35;break;case 31:this.$14(d,!1,"");r.next=34;return b("regeneratorRuntime").awrap(this.$30(d));case 34:f=r.sent;case 35:f&&(i=f.blob,i.uploadID=d.uploadID,i.name=d.name,a.setFile(i),a.getAdditionalData().set("js_resized",!0).set("original_width",f.originalWidth).set("original_height",f.originalHeight));p=i===null;a.getFile().filename=d.name;this.$9(d,i||d,p,b("performanceNow")()-e);r.next=46;break;case 41:r.prev=41,r.t0=r["catch"](6),q=b("performanceNow")()-e,this.$10(d,i||d,r.t0,q);case 46:c(a);case 47:case"end":return r.stop()}},null,this,[[6,41]])};c.$21=function(a){return!!a.files&&b("AsyncUploadRequest").isSupported()};return a}();e.exports=c}),null);
__d("ReactComposerFormattedTextActionType",["keyMirrorRecursive"],(function(a,b,c,d,e,f){"use strict";e.exports=b("keyMirrorRecursive")({SET_CATEGORIZED_TEXT_FORMATS:null,SET_TEXT_FORMATS:null,SET_SELECTED_INDEX:null,SET_SELECTED_INDEX_BUT_NOT_PREV_SELECTED_INDEX:null,SET_SELECTED_INDEX_IN_CATEGORY:null,SET_SHOULD_AUTO_OPEN_WHEN_USER_STARTS_TYPING:null,SET_SHOULD_FADE_IN_PICKER:null,TOGGLE_COLLAPSED:null,TOGGLE_TRAY_SHOWN:null,SET_COLLAPSED:null,SET_FONT_TEXT_FORMATS:null,NEXT_FONT_STYLE:null,SET_SELECTED_FONT_INDEX:null,TOGGLE_BECAME_INELIGIBLE:null,SET_FONT_STYLE:null},"ReactComposerFormattedTextActionType")}),null);
__d("ReactComposerFormattedTextStore",["ReactComposerFormattedTextActionType","ReactComposerStoreBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c;return c=a.call(this,function(){return{categorizedTextFormats:null,formattedTextPickerCollapsed:!1,prevSelectedCategory:null,selectedCategory:null,selectedIndex:-1,prevSelectedIndex:-1,shouldAutoOpenWhenUserStartsTyping:!1,shouldFadeInPicker:!1,textFormats:null,allFontTextFormats:null,selectedFontIndex:0,becameIneligible:!1}},function(a){__p&&__p();switch(a.type){case b("ReactComposerFormattedTextActionType").SET_SELECTED_INDEX:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore1(a);break;case b("ReactComposerFormattedTextActionType").SET_SELECTED_INDEX_BUT_NOT_PREV_SELECTED_INDEX:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore2(a);break;case b("ReactComposerFormattedTextActionType").SET_SELECTED_INDEX_IN_CATEGORY:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore3(a);break;case b("ReactComposerFormattedTextActionType").SET_SHOULD_AUTO_OPEN_WHEN_USER_STARTS_TYPING:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore4(a);break;case b("ReactComposerFormattedTextActionType").SET_SHOULD_FADE_IN_PICKER:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore5(a);break;case b("ReactComposerFormattedTextActionType").SET_TEXT_FORMATS:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore6(a);break;case b("ReactComposerFormattedTextActionType").SET_CATEGORIZED_TEXT_FORMATS:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore7(a);break;case b("ReactComposerFormattedTextActionType").TOGGLE_COLLAPSED:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore8(a);break;case b("ReactComposerFormattedTextActionType").SET_COLLAPSED:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore9(a);break;case b("ReactComposerFormattedTextActionType").SET_FONT_TEXT_FORMATS:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore10(a);break;case b("ReactComposerFormattedTextActionType").NEXT_FONT_STYLE:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore11(a);break;case b("ReactComposerFormattedTextActionType").SET_SELECTED_FONT_INDEX:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore12(a);break;case b("ReactComposerFormattedTextActionType").TOGGLE_BECAME_INELIGIBLE:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore13(a);break;case b("ReactComposerFormattedTextActionType").SET_FONT_STYLE:babelHelpers.assertThisInitialized(c)&&c.$ReactComposerFormattedTextStore14(a);break}})||this}var d=c.prototype;d.getTrackingString=function(a){var b=this.getSelectedCategory(a),c=this.getSelectedIndex(a),d=this.getPrevSelectedIndex(a),e;if(b!=null){b=this.$ReactComposerFormattedTextStore15(b,this.getComposerData(a).categorizedTextFormats);e=this.$ReactComposerFormattedTextStore16(c,b);e===null&&(e=this.$ReactComposerFormattedTextStore16(d,b))}else e=this.$ReactComposerFormattedTextStore16(c,this.getComposerData(a).textFormats),e===null&&(e=this.$ReactComposerFormattedTextStore16(d,this.getComposerData(a).textFormats));return e!=null?e.trackingString:null};d.getTextFormatPresetID=function(a){return this.getComposerData(a).textFormatPresetID};d.getPrevSelectedTextFormatPresetID=function(a){var b=this.getPrevSelectedCategory(a);return b!=null?this.$ReactComposerFormattedTextStore17(this.getPrevSelectedIndex(a),b,this.getComposerData(a).categorizedTextFormats):this.$ReactComposerFormattedTextStore18(this.getPrevSelectedIndex(a),this.getComposerData(a).textFormats)};d.getBackgroundColorIsActive=function(a){return this.getComposerData(a).selectedIndex>-1};d.getSelectedCategory=function(a){return this.getComposerData(a).selectedCategory};d.getSelectedIndex=function(a){return this.getComposerData(a).selectedIndex};d.getPrevSelectedIndex=function(a){return this.getComposerData(a).prevSelectedIndex};d.getPrevSelectedCategory=function(a){return this.getComposerData(a).prevSelectedCategory};d.getShouldAutoOpenWhenUserStartsTyping=function(a){return this.getComposerData(a).shouldAutoOpenWhenUserStartsTyping};d.getShouldFadeInPicker=function(a){return this.getComposerData(a).shouldFadeInPicker};d.getCollapsed=function(a){return this.getComposerData(a).formattedTextPickerCollapsed};d.getCurrentFontPresets=function(a){var b=this.getComposerData(a).allFontTextFormats;a=this.getComposerData(a).selectedFontIndex;return b===null||b.length<=a?null:b[a]};d.getBecameIneligible=function(a){return this.getComposerData(a).becameIneligible};d.getSelectedFontIndex=function(a){return this.getComposerData(a).selectedFontIndex};d.$ReactComposerFormattedTextStore1=function(a){__p&&__p();a=this.validateAction(a,["composerID","selectedIndex"]);var b=a[0];a=a[1];var c=this.getComposerData(b);c.textFormatPresetID=this.$ReactComposerFormattedTextStore18(a,c.textFormats);c.selectedCategory=null;c.prevSelectedCategory=null;c.selectedIndex=a;c.prevSelectedIndex=a;this.emitChange(b)};d.$ReactComposerFormattedTextStore2=function(a){a=this.validateAction(a,["composerID","selectedIndex"]);var b=a[0];a=a[1];var c=this.getComposerData(b);c.textFormatPresetID=this.$ReactComposerFormattedTextStore18(a,c.textFormats);c.selectedIndex=a;this.emitChange(b)};d.$ReactComposerFormattedTextStore3=function(a){__p&&__p();a=this.validateAction(a,["composerID","selectedIndex","selectedCategory"]);var b=a[0],c=a[1];a=a[2];var d=this.getComposerData(b);d.textFormatPresetID=this.$ReactComposerFormattedTextStore17(c,a,d.categorizedTextFormats);d.selectedIndex=c;d.selectedCategory=a;d.prevSelectedIndex=c;d.prevSelectedCategory=a;this.emitChange(b)};d.$ReactComposerFormattedTextStore4=function(a){a=this.validateAction(a,["composerID","shouldAutoOpenWhenUserStartsTyping"]);var b=a[0];a=a[1];var c=this.getComposerData(b);c.shouldAutoOpenWhenUserStartsTyping=a;this.emitChange(b)};d.$ReactComposerFormattedTextStore5=function(a){a=this.validateAction(a,["composerID","shouldFadeInPicker"]);var b=a[0];a=a[1];var c=this.getComposerData(b);c.shouldFadeInPicker=a;this.emitChange(b)};d.$ReactComposerFormattedTextStore6=function(a){a=this.validateAction(a,["composerID","textFormats"]);var b=a[0];a=a[1];var c=this.getComposerData(b);c.textFormats=a;this.emitChange(b)};d.$ReactComposerFormattedTextStore7=function(a){a=this.validateAction(a,["composerID","categorizedTextFormats"]);var b=a[0];a=a[1];var c=this.getComposerData(b);c.categorizedTextFormats=a;this.emitChange(b)};d.$ReactComposerFormattedTextStore8=function(a){a=this.validateAction(a,"composerID");var b=this.getComposerData(a);b.formattedTextPickerCollapsed=!b.formattedTextPickerCollapsed;this.emitChange(a)};d.$ReactComposerFormattedTextStore9=function(a){a=this.validateAction(a,["composerID","formattedTextPickerCollapsed"]);var b=a[0];a=a[1];var c=this.getComposerData(b);c.formattedTextPickerCollapsed=a;this.emitChange(b)};d.$ReactComposerFormattedTextStore10=function(a){a=this.validateAction(a,["composerID","textFormats"]);var b=a[0];a=a[1];var c=this.getComposerData(b);c.allFontTextFormats=a;this.emitChange(b)};d.$ReactComposerFormattedTextStore11=function(a){a=this.validateAction(a,["composerID","includeDisableSATPInListOfFonts"]);var b=a[0];a=a[1];var c=this.getComposerData(b),d=c.allFontTextFormats.length,e=c.selectedFontIndex;c.selectedFontIndex=(c.selectedFontIndex+1)%d;c.selectedFontIndex===0&&a&&(e===-1?(c.selectedIndex=c.prevSelectedIndex,c.formattedTextPickerCollapsed=!1):(c.selectedFontIndex=-1,c.prevSelectedIndex=c.selectedIndex,c.selectedIndex=-1,c.formattedTextPickerCollapsed=!0));a=(d=c.allFontTextFormats[c.selectedFontIndex])!=null?d:null;c.textFormats=a?a.textFormats:null;this.emitChange(b)};d.$ReactComposerFormattedTextStore12=function(a){a=this.validateAction(a,["composerID","index"]);var b=a[0];a=a[1];var c=this.getComposerData(b);c.selectedFontIndex=a;this.emitChange(b)};d.$ReactComposerFormattedTextStore13=function(a){a=this.validateAction(a,"composerID");var b=this.getComposerData(a);b.becameIneligible=!b.becameIneligible;this.emitChange(a)};d.$ReactComposerFormattedTextStore14=function(a){var b;a=this.validateAction(a,["composerID","index"]);var c=a[0];a=a[1];var d=this.getComposerData(c);b=(b=d.allFontTextFormats[a])!=null?b:null;d.selectedFontIndex=a;d.textFormats=b?b.textFormats:null;this.emitChange(c)};d.$ReactComposerFormattedTextStore18=function(a,b){a=this.$ReactComposerFormattedTextStore16(a,b);return a&&a.presetID?a.presetID:null};d.$ReactComposerFormattedTextStore17=function(a,b,c){b=this.$ReactComposerFormattedTextStore15(b,c);c=this.$ReactComposerFormattedTextStore16(a,b);return c&&Object.prototype.hasOwnProperty.call(c,"presetID")?c.presetID:null};d.$ReactComposerFormattedTextStore15=function(a,b){if(a==null||b==null)return null;for(var c=0;c<b.length;c++)if(b[c].categoryName===a)return b[c].textFormats;return null};d.$ReactComposerFormattedTextStore16=function(a,b){return a!=null&&a!==-1&&b&&Object.prototype.hasOwnProperty.call(b,a)?b[a]:null};return c}(b("ReactComposerStoreBase"));e.exports=new a()}),null);
__d("ReactComposerFormattedTextActions",["ReactComposerDispatcher","ReactComposerFormattedTextActionType","ReactComposerFormattedTextStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("ReactComposerFormattedTextStore");a=function(){__p&&__p();function a(){}var c=a.prototype;c.setSelectedIndex=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_SELECTED_INDEX,selectedIndex:c})};c.setSelectedIndexButNotPrevSelectedIndex=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_SELECTED_INDEX_BUT_NOT_PREV_SELECTED_INDEX,selectedIndex:c})};c.setSelectedIndexInCategory=function(a,c,d){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_SELECTED_INDEX_IN_CATEGORY,selectedCategory:c,selectedIndex:d})};c.setShouldAutoOpenWhenUserStartsTyping=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_SHOULD_AUTO_OPEN_WHEN_USER_STARTS_TYPING,shouldAutoOpenWhenUserStartsTyping:c})};c.setShouldFadeInPicker=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_SHOULD_FADE_IN_PICKER,shouldFadeInPicker:c})};c.setTextFormats=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_TEXT_FORMATS,textFormats:c})};c.setCategorizedTextFormats=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_CATEGORIZED_TEXT_FORMATS,categorizedTextFormats:c})};c.toggleCollapsed=function(a){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").TOGGLE_COLLAPSED})};c.setCollapsed=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_COLLAPSED,formattedTextPickerCollapsed:c})};c.setFontTextFormats=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_FONT_TEXT_FORMATS,textFormats:c})};c.nextFont=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").NEXT_FONT_STYLE,includeDisableSATPInListOfFonts:c})};c.setSelectedFontIndex=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_SELECTED_FONT_INDEX,index:c})};c.toggleBecameIneligible=function(a){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").TOGGLE_BECAME_INELIGIBLE})};c.setFont=function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("ReactComposerFormattedTextActionType").SET_FONT_STYLE,index:c})};return a}();e.exports=new a()}),null);
__d("SATPFontPickerEntryPoint",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ICON:"ICON",PLAINTEXT_BUTTON:"PLAINTEXT_BUTTON",SPROUT:"SPROUT"})}),null);
__d("XStickyFormattedTextController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/sticky_formatted_text/",{preset_id:{type:"Int"},is_set:{type:"Bool",defaultValue:!1}})}),null);
__d("ReactComposerFormattedTextPickerContainerMixin",["invariant","Arbiter","AsyncRequest","ReactComposerAttachmentStore","ReactComposerEventAttachmentStore","ReactComposerEvents","ReactComposerFormattedTextActions","ReactComposerFormattedTextPickerComponent.react","ReactComposerFormattedTextStore","ReactComposerMediaUploadStore","ReactComposerMinutiaeAttachmentStore","ReactComposerPostToGroupStore","ReactComposerPrefillStore","ReactComposerPropsAndStoreBasedStateMixin","ReactComposerScrapedAttachmentStore","ReactComposerStatusStore","ReactComposerStore","ReactComposerTaggerActions","ReactComposerTaggerEligibilityUtils","ReactComposerTaggerStore","ReactComposerTaggerType","SATPFontPickerEntryPoint","SATPInteractionsTypedLogger","SATPPresetCollection","XStickyFormattedTextController","bind"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=!0;a={_prefillSubscription:void 0,_inlinePickerFormatsImpressionsLogged:!1,_trayCategorizedFormatsImpressionsLogged:!1,mixins:[b("ReactComposerPropsAndStoreBasedStateMixin")(b("ReactComposerAttachmentStore"),b("ReactComposerEventAttachmentStore"),b("ReactComposerFormattedTextStore"),b("ReactComposerMediaUploadStore"),b("ReactComposerMinutiaeAttachmentStore"),b("ReactComposerPostToGroupStore"),b("ReactComposerScrapedAttachmentStore"),b("ReactComposerStatusStore"),b("ReactComposerStore"),b("ReactComposerTaggerStore"))],statics:{beforeCalculateInitialState:function(a,c,d){__p&&__p();h&&(b("ReactComposerFormattedTextActions").setSelectedIndex(a,c.defaultFormat!=null?c.defaultFormat:b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR),c.shouldAutoOpenWhenUserStartsTyping&&b("ReactComposerFormattedTextActions").setShouldAutoOpenWhenUserStartsTyping(a,c.shouldAutoOpenWhenUserStartsTyping));c.entryPoint===b("SATPFontPickerEntryPoint").PLAINTEXT_BUTTON&&(b("ReactComposerFormattedTextActions").setSelectedFontIndex(a,-1),b("ReactComposerFormattedTextActions").setCollapsed(d.composerID,!0));d.gks&&(d.gks.collapseSATPInitially||d.gks.showUserComposer)&&b("ReactComposerFormattedTextActions").setCollapsed(d.composerID,!0);if(c.stickyStylesEnabled&&!h){d=b("XStickyFormattedTextController").getURIBuilder().setBool("is_set",!1).getURI();new(b("AsyncRequest"))().setURI(d).setHandler(b("bind")(this,function(d){if(d&&d.payload&&d.payload.index!=null){var e=d.payload.index;e===b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR&&!d.payload.hasUserUnformattedText&&(e=c.defaultFormat!=null?c.defaultFormat:b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR);b("ReactComposerFormattedTextActions").setSelectedIndex(a,e)}})).send()}},calculateState:function(a,c,d){__p&&__p();var e=b("ReactComposerTaggerEligibilityUtils").isSATPEligible(a,c),f=b("ReactComposerTaggerStore").getSelectedTagger(a)===b("ReactComposerTaggerType").FORMATTED_TEXT_TRAY;if(e){if(!this._inlinePickerFormatsImpressionsLogged&&b("ReactComposerStatusStore").getTextLength(a)>0){this._inlinePickerFormatsImpressionsLogged=!0;for(var g=c.textFormats,h=Array.isArray(g),i=0,g=h?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=g.length)break;j=g[i++]}else{i=g.next();if(i.done)break;j=i.value}j=j;new(b("SATPInteractionsTypedLogger"))().setTrackingString(j.trackingString).setUserActionString("impression").setPresetID(j.presetID).setRequestedCollection(b("SATPPresetCollection").COMPOSER_TOP).log()}}if(!this._trayCategorizedFormatsImpressionsLogged&&f){this._trayCategorizedFormatsImpressionsLogged=!0;for(var j=c.categorizedTextFormatPresets,i=Array.isArray(j),h=0,j=i?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(i){if(h>=j.length)break;g=j[h++]}else{h=j.next();if(h.done)break;g=h.value}g=g;g=g.textFormats;for(var g=g,k=Array.isArray(g),l=0,g=k?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=g.length)break;m=g[l++]}else{l=g.next();if(l.done)break;m=l.value}m=m;new(b("SATPInteractionsTypedLogger"))().setTrackingString(m.trackingString).setUserActionString("impression").setPresetID(m.presetID).setRequestedCollection(b("SATPPresetCollection").COMPOSER_ALL).log()}}}}m=c.textFormats;l=b("ReactComposerFormattedTextStore").getCurrentFontPresets(a);l!==null&&l!==void 0&&(m=l.textFormats);k=b("ReactComposerTaggerStore").getSelectedTagger(a)===this.taggerID;return{isSelected:k,canUseFormattedText:e,collapsed:b("ReactComposerFormattedTextStore").getCollapsed(a),fadingInPicker:b("ReactComposerFormattedTextStore").getShouldFadeInPicker(a),prevSelectedIndex:b("ReactComposerFormattedTextStore").getPrevSelectedIndex(a),prevSelectedCategory:b("ReactComposerFormattedTextStore").getPrevSelectedCategory(a),selectedCategory:b("ReactComposerFormattedTextStore").getSelectedCategory(a),selectedIndex:b("ReactComposerFormattedTextStore").getSelectedIndex(a),shouldAutoOpenWhenUserStartsTyping:b("ReactComposerFormattedTextStore").getShouldAutoOpenWhenUserStartsTyping(a),shouldDisplay:e&&(c.noSproutDesign||k),taggerData:b("ReactComposerTaggerStore").getTaggerData(a,this.taggerID),taggerSource:b("ReactComposerTaggerStore").getTaggerSource(a,this.taggerID),trayShown:f,exceedCharacterCount:d.gks&&d.gks.canProduceLongTextSATP&&b("ReactComposerTaggerEligibilityUtils").exceedSATPCharacterCountOrExceedNewLinesCount(a,c),currentFontPresets:b("ReactComposerFormattedTextStore").getCurrentFontPresets(a),textFormats:m,becameIneligible:b("ReactComposerFormattedTextStore").getBecameIneligible(a),currentFontIndex:b("ReactComposerFormattedTextStore").getSelectedFontIndex(a)}}},handleSaveStickyPreset:function(a){if(!this.props.stickyStylesEnabled)return;a=b("XStickyFormattedTextController").getURIBuilder().setString("preset_id",a===b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR?0:b("ReactComposerFormattedTextStore").getTextFormatPresetID(this.context.composerID)).setBool("is_set",!0).getURI();new(b("AsyncRequest"))().setMethod("POST").setURI(a).send()},UNSAFE_componentWillMount:function(){this._prefillSubscription=b("Arbiter").subscribe(b("ReactComposerEvents").SET_PREFILL_DATA+this.context.composerID,this._handlePrefill),this.constructor.taggerID||g(0,4299)},componentDidMount:function(){var a=this;h&&(this.props.autoOpen&&window.setTimeout(function(){b("ReactComposerFormattedTextActions").setShouldFadeInPicker(a.context.composerID,!0),b("ReactComposerTaggerStore").getSelectedTagger(a.context.composerID)===null&&b("ReactComposerTaggerActions").selectTaggerWithoutLogging(a.context.composerID,a.constructor.taggerID)},0),h=!1)},componentWillUnmount:function(){this._prefillSubscription&&this._prefillSubscription.unsubscribe(),this._prefillSubscription=null},_handlePrefill:function(){__p&&__p();var a=b("ReactComposerPrefillStore").getAndEraseNestedField(this.context.composerID,["taggersData",this.constructor.taggerID]);if(a){var c;b("ReactComposerTaggerActions").setTaggerDataWithoutLogging(this.context.composerID,this.constructor.taggerID,a);if((c=a)!=null?c.prefillPresetID:c){var d=this.context.composerID;this.props.textFormats.forEach(function(c,e){c.presetID===String(a.prefillPresetID)&&b("ReactComposerFormattedTextActions").setSelectedIndex(d,e)})}}}};e.exports=a}),null);
__d("ComposerFormattedTextFontPickerComponent.react",["ix","cx","fbt","ClickableArea.react","ClickableAreaButton.react","ContextualLayerUpdateOnScroll","Grid.react","ReactAbstractContextualDialog","ReactComposerFormattedTextPickerComponent.react","Image.react","Link.react","React","LayerHideOnBlur","LayerHideOnEscape","ReactLayer","ShimButton.react","asset"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();b("Grid.react").GridItem;a=b("React").PropTypes;c={wrapperClassName:"_8d1e"};var j=b("ReactLayer").createClass(b("ReactAbstractContextualDialog").createSpec({displayName:"ComposerFormattedTextFontPickerMenu",theme:c}));d=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c;c=a.call(this)||this;c.state={isFontMenuVisible:!1,isFontPickerHovered:!1,isCancelIconHovered:!1};c.$9=function(){c.setState({isFontPickerHovered:!0})};c.$10=function(){c.setState({isFontPickerHovered:!1})};c.$7=function(){!c.state.isFontMenuVisible&&c.props.fadeMenuOnHoverCancel&&c.setState({isCancelIconHovered:!0})};c.$6=function(){c.setState({isCancelIconHovered:!1})};c.$14=function(a){a!==c.state.isFontMenuVisible&&c.setState(function(a){return{isFontMenuVisible:!a.isFontMenuVisible}})};c.$12=function(){c.props.collapsed?(c.props.onToggle(),c.props.onClickFontButton()):c.$14()};c.$1=b("React").createRef();return c}var d=c.prototype;d.$2=function(a){this.props.onSelect&&this.props.onSelect(a)};d.$3=function(){this.props.onSelect&&this.props.onSelect(-1),this.props.onToggle&&this.props.onToggle()};d.$4=function(){var a=[];for(var c=0;c<this.props.textFormats.length;c++){var d=c===this.props.selectedIndex&&c!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR,e=c!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR&&!!this.props.textFormats[c].keyframesAnimation,f=this.props.textFormats[c]?this.props.textFormats[c].accessibilityLabel+(c===this.props.selectedIndex?i._(", selected"):""):"";f=b("React").createElement("div",{key:c+2,className:this.props.noSproutDesign?"_4ydj":""},b("React").createElement("div",{className:d?"_4ydk":""},b("React").createElement(b("Link.react"),{tabIndex:this.props.collapsed?-1:null,href:"#","aria-label":f,onClick:c===this.props.selectedIndex?null:this.$2.bind(this,c)},b("React").createElement("div",{className:"_2j78 _74_0"+(d?" _4ydl":"")+(d?" _7bep":"")+(this.props.collapsed?" _4vb-":""),style:c===b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR?null:this.props.textFormats[c].swatchStyle}),e?b("React").createElement(b("Image.react"),{src:g("497826"),className:"_3mwi"}):null)));a.push(f)}d=this.props.cancelButtonType==="SWATCH";return b("React").createElement("div",{className:"_8d1f"+(!this.props.collapsed&&(this.state.isFontMenuVisible||this.state.isFontPickerHovered||this.state.isCancelIconHovered)?" _8d1g":"")+(!d&&!this.props.collapsed&&(this.state.isFontMenuVisible||this.state.isFontPickerHovered)?" _8d1h":"")+(d?" _8d1i":"")+(!this.props.collapsed&&this.state.isCancelIconHovered?" _8d1j":"")},a)};d.$5=function(a){return b("React").createElement("div",{className:"_8d1f"+(a?"":" _8d1i")+(this.state.isFontMenuVisible||this.state.isFontPickerHovered?" _8d1g":"")+(a&&!this.props.collapsed&&(this.state.isFontMenuVisible||this.state.isFontPickerHovered)?" _8d1h":"")+(this.state.isCancelIconHovered?" _8d1k":"")},b("React").createElement(b("ClickableArea.react"),{onMouseLeave:a?null:this.$6,onMouseEnter:a?null:this.$7,onClick:this.$3.bind(this)},b("React").createElement("div",{className:(a?"_2j78":"")+(a?" _74_0":"")+(a?"":" _74-_")+" _23ju _74_1"+(this.props.collapsed?" _4vb-":"")},a?null:this.$8())))};d.$8=function(){return b("React").createElement("div",{className:"_8d1l"},b("React").createElement(b("Image.react"),{src:g("478238")}),b("React").createElement("div",{className:"_88hu _8d1m"},this.state.isCancelIconHovered?i._("Remove Background"):null))};d.$11=function(a){a=b("React").createElement(b("ClickableArea.react"),{onClick:this.$12,onMouseEnter:this.$9,onMouseLeave:this.$10},b("React").createElement("div",{ref:this.$1,key:this.props.textFormats.length+2,className:(this.props.noSproutDesign?"_4ydj":"")+" _74_2 _8d1f"+(this.props.collapsed||this.state.isFontMenuVisible||this.state.isFontPickerHovered?" _8d1i":"")+(!this.props.collapsed&&this.state.isCancelIconHovered?" _8d1g":"")},this.$13(),b("React").createElement(b("ShimButton.react"),{className:"_88hx"},b("React").createElement("div",{className:"_88hu"},a.toString().toLowerCase()),b("React").createElement("div",{className:"_88ht"+(this.props.collapsed?"":" _88it")},b("React").createElement(b("Image.react"),{src:g("492547")})))));return a};d.$13=function(){return this.props.collapsed?b("React").createElement("div",{key:0,className:"_w4h _88io"},b("React").createElement(b("ClickableAreaButton.react"),{onClick:this.props.onToggle,label:this.props.collapsed?i._("Show background options"):i._("Hide background options")},b("React").createElement("div",{className:"_88in"+(this.props.collapsed?" _2j7a":"")},b("React").createElement("div",{className:this.props.collapsed?"":"_2j7b"})))):null};d.$15=function(a){var c=this;return b("React").createElement(j,{label:i._("Font menu"),alignment:this.props.alignment,behaviors:{ContextualLayerUpdateOnScroll:b("ContextualLayerUpdateOnScroll"),LayerHideOnBlur:b("LayerHideOnBlur"),LayerHideOnEscape:b("LayerHideOnEscape")},contextRef:function(){return c.$1.current},position:"above",shown:this.state.isFontMenuVisible,onToggle:this.$14},this.props.allStyles.map(function(d,e){return d!==a?b("React").createElement(b("ClickableAreaButton.react"),{label:d,key:e,onClick:function(){return c.$16(e)}},b("React").createElement("div",{className:"_8d1n _88hu"},d.toLowerCase())):null}))};d.$16=function(a){this.props.selectFontStyle(a),this.$14()};d.render=function(){var a=this.props.collapsed?i._("Background"):this.props.currentFontPresets&&this.props.currentFontPresets.collectionName.text,c=this.$4(),d=this.$11(a),e=this.props.cancelButtonType==="SWATCH",f=this.$5(e);a=this.$15(a);return b("React").createElement("div",{className:"_4ukb _8d1o"},d,e?f:null,c,e?null:f,a)};return c}(b("React").Component);d.propTypes={collapsed:a.bool,composerBodyWidth:a.number,disableNoBgColor:a.bool,hidden:a.bool,onSelect:a.func.isRequired,onToggle:a.func,onTrayToggle:a.func,selectedIndex:a.number,suppressTransition:a.bool,textFormats:a.arrayOf(a.object).isRequired,currentFontPresets:a.shape(b("ReactComposerFormattedTextPickerComponent.react").FontTextFormat),onClickFontButton:a.func,blackFontPicker:a.bool,inlineEmojiPicker:a.bool,cancelButtonType:a.string,allStyles:a.arrayOf(a.string),selectFontStyle:a.func,fadeMenuOnHoverCancel:a.bool,exceedCharacterCount:a.bool,onChange:a.func,putEmojiPickerBySATPSelector:a.bool};e.exports=d}),null);
__d("ReactComposerFormattedTextPickerButton.react",["cx","fbt","React","ReactComposerLoggingName","ReactComposerTaggerButtonMixin","ReactComposerTaggerType"],(function(a,b,c,d,e,f,g,h){"use strict";a=b("React").createClass({displayName:"ReactComposerFormattedTextPickerButton",mixins:[b("ReactComposerTaggerButtonMixin")],statics:{taggerID:b("ReactComposerTaggerType").FORMATTED_TEXT,loggingName:b("ReactComposerLoggingName").FORMATTED_TEXT_BUTTON},getTitle:function(){return h._("Add a background color to your post")},getTooltip:function(){return h._("Add a background color to your post")},getClassName:function(){return"_cod"}});e.exports=a}),null);
__d("ReactComposerFormattedTextPickerContainer.react",["csx","cx","Arbiter","Bootloader","ComposerEntryPointRef","ComposerFormattedTextFontPickerComponent.react","CSS","DOM","DOMQuery","React","ReactComposerEvents","ReactComposerFormattedTextActions","ReactComposerFormattedTextPickerComponent.react","ReactComposerFormattedTextPickerContainerMixin","ReactComposerFormattedTextStore","ReactComposerLoggingName","ReactComposerPrefillConfig","ReactComposerTaggerActions","ReactComposerTaggerType","SATPInteractionsTypedLogger","SATPPresetCollection","ge","getElementRect","gkx","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"ReactComposerFormattedTextPickerContainer",_composerMountSubscription:void 0,_suppressTransition:!1,_memoizedComposerID:null,_memoizedComposerRoot:null,_memoizedComposerBody:null,_memoizedComposerBodyWidth:null,_memoizedComposerOverlay:null,_memoizedComposerWrapper:null,_memoizedComposerTaggerDiv:null,mixins:[b("ReactComposerFormattedTextPickerContainerMixin")],propTypes:{autoOpen:a.bool,categorizedTextFormatPresets:a.arrayOf(a.object).isRequired,categorizedTrayEnabled:a.bool,defaultFormat:a.number,disableSATPMemoization:a.bool,disableNoBgColor:a.bool,hidePicker:a.bool,maxNewlines:a.number,noSproutDesign:a.bool,prefillConfig:b("ReactComposerPrefillConfig"),statusAttachmentActive:a.bool,stickyStylesEnabled:a.bool,textLengthLimit:a.number,allFontTextFormats:a.arrayOf(a.object),currentFontPresets:a.shape(b("ReactComposerFormattedTextPickerComponent.react").FontTextFormat),inlineEmojiPicker:a.bool,cancelButtonType:a.string,fadeMenuOnHoverCancel:a.bool,exceedCharacterCount:a.bool,onMentionsInputChange:a.func,putEmojiPickerBySATPSelector:a.bool},statics:{taggerID:b("ReactComposerTaggerType").FORMATTED_TEXT,loggingName:b("ReactComposerLoggingName").FORMATTED_TEXT_TAGGER},render:function(){__p&&__p();this._updateBackground(this.state.selectedIndex,this.state.selectedCategory);if(!this.state.shouldDisplay)return null;var a=this._getStyles(this.state.selectedIndex,this.state.selectedCategory);a=b("gkx")("860754")?a.backgroundColor==="FFFFFFFF":a.bodyStyle.includes("(255,255,255");if(this._canProduceSATPWithFont()){var c;c=((c=this.props.allFontTextFormats)!=null?c:[]).map(function(a){return a==null?void 0:(a=a.collectionName)==null?void 0:a.text}).filter(function(a){return a!=null});return b("React").createElement(b("ComposerFormattedTextFontPickerComponent.react"),{collapsed:this.state.collapsed,composerBodyWidth:this._getComposerBodyWidth(),disableNoBgColor:this.props.disableNoBgColor,hidden:this.props.hidePicker||this.state.fadingInPicker,onSelect:this._onSelect,onSelectInCategorizedFormatTray:this._onSelectInCategorizedFormatTray,onToggle:this._onToggle,onTrayToggle:this._onTrayToggle,selectedIndex:this.state.selectedIndex,suppressTransition:this._suppressTransition,textFormats:this.state.textFormats,canProduceSATPWithFont:this._canProduceSATPWithFont(),currentFontPresets:this.state.currentFontPresets,onClickFontButton:this._selectFirstFont,blackFontPicker:this._canProduceSATPWithFont()&&(this.state.selectedIndex===-1||a),inlineEmojiPicker:this.props.inlineEmojiPicker,cancelButtonType:this.props.cancelButtonType,allStyles:c,selectFontStyle:this._selectFontStyle,fadeMenuOnHoverCancel:this.props.fadeMenuOnHoverCancel,exceedCharacterCount:this.props.exceedCharacterCount,onMentionsInputChange:this.props.onMentionsInputChange,putEmojiPickerBySATPSelector:this.props.putEmojiPickerBySATPSelector})}return b("React").createElement(b("ReactComposerFormattedTextPickerComponent.react"),{categorizedTextFormatPresets:this.props.categorizedTextFormatPresets,categorizedTrayEnabled:this.props.categorizedTrayEnabled,collapsed:this.state.collapsed,composerBodyWidth:this._getComposerBodyWidth(),disableNoBgColor:this.props.disableNoBgColor,hidden:this.props.hidePicker||this.state.fadingInPicker,noSproutDesign:this.props.noSproutDesign,onSelect:this._onSelect,onSelectInCategorizedFormatTray:this._onSelectInCategorizedFormatTray,onToggle:this._onToggle,onTrayToggle:this._onTrayToggle,selectedCategory:this.state.selectedCategory,selectedIndex:this.state.selectedIndex,suppressTransition:this._suppressTransition,textFormats:this.state.textFormats,trayShown:this.state.trayShown,canProduceSATPWithFont:this._canProduceSATPWithFont(),currentFontPresets:this.state.currentFontPresets,onClickFontButton:this._selectFirstFont,blackFontPicker:this._canProduceSATPWithFont()&&(this.state.selectedIndex===-1||a),inlineEmojiPicker:this.props.inlineEmojiPicker,exceedCharacterCount:this.props.exceedCharacterCount,onMentionsInputChange:this.props.onMentionsInputChange,putEmojiPickerBySATPSelector:this.props.putEmojiPickerBySATPSelector})},UNSAFE_componentWillMount:function(){var a=this;b("ReactComposerTaggerActions").setTaggerConfig(this.context.composerID,this.taggerID,{maxNewlines:this.props.maxNewlines,textLengthLimit:this.props.textLengthLimit});this._composerMountSubscription=b("Arbiter").subscribe(b("ReactComposerEvents").INSTANCE_MOUNTED+this.context.composerID,function(){a._memoizedComposerID=null,a._memoizedComposerRoot=null,a._memoizedComposerBody=null,a._memoizedComposerBodyWidth=null,a._memoizedComposerOverlay=null,a._memoizedComposerWrapper=null,a._memoizedComposerTaggerDiv=null})},componentWillUnmount:function(){this.state.selectedIndex!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR&&this._updateBackground(b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR,this.state.selectedCategory),this._composerMountSubscription&&this._composerMountSubscription.unsubscribe(),this._composerMountSubscription=null},componentDidMount:function(){__p&&__p();var a=this;this.props.allFontTextFormats!==null&&this.props.allFontTextFormats!==void 0&&b("ReactComposerFormattedTextActions").setFontTextFormats(this.context.composerID,this.props.allFontTextFormats);b("ReactComposerFormattedTextActions").setTextFormats(this.context.composerID,this.state.textFormats);b("ReactComposerFormattedTextActions").setCategorizedTextFormats(this.context.composerID,this.props.categorizedTextFormatPresets);if(this.props.noSproutDesign){var c=this._getComposerBody();c&&b("CSS").addClass(c,"_2j7c")}this.props.prefillConfig&&this.props.prefillConfig.taggersData&&this.props.prefillConfig.taggersData[b("ReactComposerTaggerType").FORMATTED_TEXT]&&this.props.prefillConfig.taggersData[b("ReactComposerTaggerType").FORMATTED_TEXT].defaultFormatIndex!==null&&(b("ReactComposerFormattedTextActions").setSelectedIndex(this.context.composerID,this.props.prefillConfig.taggersData[b("ReactComposerTaggerType").FORMATTED_TEXT].defaultFormatIndex),b("Bootloader").loadModules(["ReactComposerFocusActions"],function(b){b.notifyFocusAcquired(a.context.composerID)},"ReactComposerFormattedTextPickerContainer.react"))},UNSAFE_componentWillUpdate:function(a,c){this.state.selectedIndex!==c.selectedIndex&&(this.state.selectedIndex===b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR||c.selectedIndex===b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR)&&(this._suppressTransition=!0),c.selectedIndex!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR&&(this.state.selectedIndex!==c.selectedIndex||this.state.textFormats&&this.state.textFormats.length>0&&c.textFormats&&c.textFormats.length>0&&this.state.textFormats[0].presetID!==c.textFormats[0].presetID)&&this._updateOverlay()},componentDidUpdate:function(a,c){this.state.becameIneligible&&!c.canUseFormattedText&&this.state.canUseFormattedText?(this._onBecameEligible(),b("ReactComposerFormattedTextActions").toggleBecameIneligible(this.context.composerID)):this.state.selectedIndex!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR&&c.canUseFormattedText&&!this.state.canUseFormattedText&&(this._onBecameIneligible(),b("ReactComposerFormattedTextActions").toggleBecameIneligible(this.context.composerID)),!c.isSelected&&this.state.isSelected?this._onPickerOpened():c.isSelected&&!this.state.isSelected&&this._onPickerClosed(),c.selectedIndex!==this.state.selectedIndex&&this._onSelectedIndexChanged(),c.shouldAutoOpenWhenUserStartsTyping&&this.state.shouldDisplay&&b("ReactComposerFormattedTextActions").setShouldAutoOpenWhenUserStartsTyping(this.context.composerID,!1),this.state.fadingInPicker&&this.state.shouldDisplay&&b("ReactComposerFormattedTextActions").setShouldFadeInPicker(this.context.composerID,!1)},_onPickerOpened:function(){var a=this._getComposerRoot();a&&b("CSS").removeClass(a,"_10m_");a=this.state.selectedIndex!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR;this._setShouldHideTaggersDiv(a)},_focusComposerTextInput:function(){b("Arbiter").inform(b("ReactComposerEvents").ACTIVATE_ATTACHMENT+this.context.composerID)},_onPickerClosed:function(){var a=this._getComposerRoot();a&&b("CSS").addClass(a,"_10m_");this._setShouldHideTaggersDiv(!1)},_setShouldHideTaggersDiv:function(a){var c=this._getComposerTaggerDiv();if(!c)return;a?b("CSS").addClass(c,"_10n0"):b("CSS").removeClass(c,"_10n0")},_getComposerRoot:function(){if(!this.props.disableSATPMemoization&&this._memoizedComposerRoot&&this.context.composerID===this._memoizedComposerID)return this._memoizedComposerRoot;this._memoizedComposerID=this.context.composerID;this._memoizedComposerRoot=b("ge")(this._memoizedComposerID);return this._memoizedComposerRoot},_getComposerBody:function(){if(!this.props.disableSATPMemoization&&this._memoizedComposerBody&&this.context.composerID===this._memoizedComposerID)return this._memoizedComposerBody;var a=this._getComposerRoot();if(!a)return null;this._memoizedComposerBody=this._domScry(a,"._i-o");return this._memoizedComposerBody},_getComposerBodyWidth:function(){__p&&__p();if(!this.props.disableSATPMemoization&&this._memoizedComposerBodyWidth!=null&&this.context.composerID===this._memoizedComposerID)return this._memoizedComposerBodyWidth;var a=this._getComposerBody();if(!a)return null;a=b("getElementRect")(a);if(!a)return null;this._memoizedComposerBodyWidth=a.width;return this._memoizedComposerBodyWidth},_getComposerOverlay:function(){if(!this.props.disableSATPMemoization&&this._memoizedComposerOverlay&&this.context.composerID===this._memoizedComposerID)return this._memoizedComposerOverlay;var a=this._getComposerRoot();if(!a)return null;this._memoizedComposerOverlay=this._domScry(a,"._3enz");return this._memoizedComposerOverlay},_getComposerWrapper:function(){if(!this.props.disableSATPMemoization&&this._memoizedComposerWrapper&&this.context.composerID===this._memoizedComposerID)return this._memoizedComposerWrapper;var a=this._getComposerRoot();if(!a)return null;this._memoizedComposerWrapper=this._domScry(a,"._3eny");return this._memoizedComposerWrapper},_getComposerPlaceholder:function(){var a=this._getComposerTextInput();return!a?null:this._domScry(a,"._1p1t")},_getComposerTextInput:function(){var a=this._getComposerBody();return!a?null:this._domScry(a,"._395")},_getComposerTaggerDiv:function(){if(!this.props.disableSATPMemoization&&this._memoizedComposerTaggerDiv&&this.context.composerID===this._memoizedComposerID)return this._memoizedComposerTaggerDiv;var a=this._getComposerRoot();if(!a)return null;this._memoizedComposerTaggerDiv=this._domScry(a,"._1idc");return this._memoizedComposerTaggerDiv},_domScry:function(a,c){a=b("DOMQuery").scry(a,c);return!a||a.length===0?null:a[a.length-1]},_onBecameEligible:function(){this.state.prevSelectedCategory!=null&&this.state.prevSelectedIndex!=null?b("ReactComposerFormattedTextActions").setSelectedIndexInCategory(this.context.composerID,this.state.prevSelectedCategory,this.state.prevSelectedIndex):this.state.prevSelectedIndex!=null&&b("ReactComposerFormattedTextActions").setSelectedIndex(this.context.composerID,this.state.prevSelectedIndex)},_onBecameIneligible:function(){var a=this.state.selectedIndex!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR;a&&b("ReactComposerFormattedTextActions").setSelectedIndexButNotPrevSelectedIndex(this.context.composerID,b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR)},_onSelectedIndexChanged:function(){var a=this.state.selectedIndex!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR;this.props.noSproutDesign||this._setShouldHideTaggersDiv(a);b("ReactComposerTaggerActions").setTaggerData(this.context.composerID,this.constructor.loggingName,b("ReactComposerTaggerType").FORMATTED_TEXT,{formatActive:a})},_updateBackground:function(a,c){__p&&__p();var d=this,e=this._getComposerRoot();if(!e)return;var f=this._getComposerBody();if(!f)return;var g=this._getComposerOverlay();if(!g)return;var h=this._getComposerWrapper();if(!h)return;var i=this._getStyles(a,c);b("DOM").setAttributes(f,{style:i.bodyStyle});if(a!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR)b("CSS").addClass(e,"_1mjk"),i.bodyStyle.includes("255,255,255")?b("CSS").addClass(e,"_74_t"):b("CSS").removeClass(e,"_74_t"),b("CSS").addClass(e,"_38ws"),b("CSS").addClass(f,"_2ihx"),this.context.gks&&this.context.gks.hideHeader&&b("CSS").addClass(f,"_7ea-"),this.context.composerType===b("ComposerEntryPointRef").TIMELINE&&b("CSS").addClass(f,"_7g0f"),b("CSS").addClass(h,"_2ihx"),b("CSS").addClass(g,"_2ihx"),b("CSS").addClass(g,"_4xe1");else{c=this._getStyles(this.state.selectedIndex,this.state.selectedCategory);b("DOM").setAttributes(g,{style:c.bodyStyle});b("CSS").removeClass(e,"_1mjk");b("CSS").removeClass(f,"_2ihx");this.context.gks&&this.context.gks.hideHeader&&b("CSS").removeClass(f,"_7ea-");this.context.composerType===b("ComposerEntryPointRef").TIMELINE&&b("CSS").removeClass(f,"_7g0f");b("CSS").removeClass(h,"_2ihx");b("CSS").removeClass(g,"_2ihx");b("CSS").removeClass(g,"_4xe1")}var j=this._getComposerTextInput();if(!j)return;this._updateTextDelightSpans(j,i);c=i.fontStyle;var k=c&&c["font-family"];e=c&&c["font-url"];f=typeof document.fonts==="object"&&typeof FontFace==="function";if(e&&k&&f){h=new FontFace(k,"url("+e+")");b("promiseDone")(h.load(),function(a){window.document.fonts.add(a),d.state.selectedIndex!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR&&(b("DOM").setAttributes(j,{style:i.textInputStyle}),b("DOM").setAttributes(j,{style:{fontFamily:k+", Helvetica, Arial, sans-serif"}}))})}(!this._canProduceSATPWithFont()||a===b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR)&&b("DOM").setAttributes(j,{style:i.textInputStyle});g=this._getComposerPlaceholder();if(!g)return;b("DOM").setAttributes(g,{style:i.textInputColorStyle});i.textInputColorStyle&&(g.style.opacity="0.7")},_updateTextDelightSpans:function(a,c){if(!a)return;var d=b("DOMQuery").scry(a,"._2k9q");d.forEach(function(a){b("DOM").setAttributes(a,{style:c.delightTextStyle})});d=b("DOMQuery").scry(a,"._6854");d.forEach(function(a){b("DOM").setAttributes(a,{style:c.delightButtonStyle})})},_updateOverlay:function(){__p&&__p();var a=this._getComposerRoot();if(!a)return;a=this._getComposerBody();if(!a)return;var c=this._getComposerOverlay();if(!c)return;a=this._getStyles(this.state.selectedIndex,this.state.selectedCategory);b("DOM").setAttributes(c,{style:a.bodyStyle});a=function a(d){b("CSS").removeClass(c,"_1wnq"),b("CSS").addClass(c,"_1wnr"),b("CSS").addClass(c,"_3eo2"),c.removeEventListener("transitionend",a,!1)};b("CSS").removeClass(c,"_3eo2");c.addEventListener("transitionend",a,!1);b("CSS").addClass(c,"_1wnq");b("CSS").removeClass(c,"_1wnr")},_saveStickyPreset:function(a,c){this.handleSaveStickyPreset(a);a=b("ReactComposerFormattedTextStore").getTextFormatPresetID(this.context.composerID);var d=b("ReactComposerFormattedTextStore").getTrackingString(this.context.composerID);a&&new(b("SATPInteractionsTypedLogger"))().setTrackingString(d).setUserActionString("style_applied").setPresetID(a).setRequestedCollection(c).log()},_onSelect:function(a){this.state.canUseFormattedText&&(this._canProduceSATPWithFont()&&a===b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR?b("ReactComposerFormattedTextActions").setSelectedIndexButNotPrevSelectedIndex(this.context.composerID,a):b("ReactComposerFormattedTextActions").setSelectedIndex(this.context.composerID,a),b("Arbiter").inform(b("ReactComposerEvents").ACTIVATE_ATTACHMENT+this.context.composerID),this._saveStickyPreset(a,b("SATPPresetCollection").COMPOSER_TOP))},_onSelectInCategorizedFormatTray:function(a,c){this.state.canUseFormattedText&&(b("ReactComposerFormattedTextActions").setSelectedIndexInCategory(this.context.composerID,c,a),this._saveStickyPreset(a,b("SATPPresetCollection").COMPOSER_ALL))},_onToggle:function(){var a=!this.state.collapsed;!a&&this.props.allFontTextFormats!==null&&this.props.allFontTextFormats!==void 0&&(b("Arbiter").inform(b("ReactComposerEvents").ACTIVATE_ATTACHMENT+this.context.composerID),this.state.prevSelectedIndex===b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR&&this.state.selectedIndex===b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR?this._onSelect(0):this._onSelect(this.state.prevSelectedIndex));b("ReactComposerFormattedTextActions").toggleCollapsed(this.context.composerID)},_onTrayToggle:function(){var a=b("ReactComposerFormattedTextStore").getTextFormatPresetID(this.context.composerID),c=b("ReactComposerFormattedTextStore").getTrackingString(this.context.composerID);this.state.trayShown||(a=a!=null?a:"-1",new(b("SATPInteractionsTypedLogger"))().setTrackingString(c).setUserActionString("tray_shown").setPresetID(a).setRequestedCollection(b("SATPPresetCollection").COMPOSER_ALL).log());b("ReactComposerTaggerActions").selectTagger(this.context.composerID,this.constructor.loggingName,b("ReactComposerTaggerType").FORMATTED_TEXT_TRAY,!0)},_getSelectedTextFormat:function(a,c){__p&&__p();if(a!=null&&a!==b("ReactComposerFormattedTextPickerComponent.react").NO_BG_COLOR){var d=null;if(c!=null){for(var e=0;e<this.props.categorizedTextFormatPresets.length;e++)if(this.props.categorizedTextFormatPresets[e].categoryName===c){d=this.props.categorizedTextFormatPresets[e].textFormats;break}}else d=this.state.textFormats;return d&&Object.prototype.hasOwnProperty.call(d,a)?d[a]:null}return null},_getStyles:function(a,b){var c="",d="",e="",f="",g="",h="",i="";a=this._getSelectedTextFormat(a,b);a&&a.bodyStyle&&a.textInputStyle&&(c=a.bodyStyle,d=a.textInputStyle,e=a.textInputColorStyle,f=a.delightTextStyle,g=a.delightButtonStyle);a&&a.fontStyle&&(h=a.fontStyle);a&&a.backgroundColor&&(i=a.backgroundColor);return{bodyStyle:c,textInputStyle:d,textInputColorStyle:e,delightTextStyle:f,delightButtonStyle:g,fontStyle:h,backgroundColor:i}},_selectFirstFont:function(){b("ReactComposerFormattedTextActions").setSelectedFontIndex(this.context.composerID,0),b("ReactComposerFormattedTextActions").setSelectedIndexButNotPrevSelectedIndex(this.context.composerID,0),this._updateBackground(this.state.selectedIndex,this.state.selectedCategory)},_canProduceSATPWithFont:function(){return this.props.allFontTextFormats!==null&&this.props.allFontTextFormats!==void 0},_selectFontStyle:function(a){b("ReactComposerFormattedTextActions").setFont(this.context.composerID,a)}});e.exports=c}),null);